2022-04-28 01:56:39.897  INFO 8876 --- [main] ru.otus.homework03.Main                  : Starting Main using Java 14.0.1 on DESKTOP-KDSIOVU with PID 8876 (C:\projects\otus_homework\homework03\target\classes started by yanin in C:\projects\otus_homework\homework03)
2022-04-28 01:56:39.904  INFO 8876 --- [main] ru.otus.homework03.Main                  : No active profile set, falling back to 1 default profile: "default"
2022-04-28 01:56:40.997  INFO 8876 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-04-28 01:56:41.079  INFO 8876 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 70 ms. Found 5 JPA repository interfaces.
2022-04-28 01:56:41.609  INFO 8876 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-04-28 01:56:41.620  INFO 8876 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-04-28 01:56:41.620  INFO 8876 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-04-28 01:56:41.758  INFO 8876 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-04-28 01:56:41.758  INFO 8876 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1810 ms
2022-04-28 01:56:41.873  INFO 8876 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-04-28 01:56:41.996  INFO 8876 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-04-28 01:56:42.007  INFO 8876 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2022-04-28 01:56:42.300  INFO 8876 --- [main] liquibase.database                       : Set default schema name to PUBLIC
2022-04-28 01:56:42.507  INFO 8876 --- [main] liquibase.lockservice                    : Successfully acquired change log lock
2022-04-28 01:56:42.533  INFO 8876 --- [main] liquibase.changelog                      : Reading resource: db/changelog/1.0/2022-03-01--0001.xml
2022-04-28 01:56:42.984  INFO 8876 --- [main] liquibase.changelog                      : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2022-04-28 01:56:42.986  INFO 8876 --- [main] liquibase.changelog                      : Reading from PUBLIC.DATABASECHANGELOG
2022-04-28 01:56:43.068  INFO 8876 --- [main] liquibase.changelog                      : Table authors created
2022-04-28 01:56:43.068  INFO 8876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-authorsTableCreate::ryanin ran successfully in 23ms
2022-04-28 01:56:43.085  INFO 8876 --- [main] liquibase.changelog                      : Table genres created
2022-04-28 01:56:43.086  INFO 8876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-genresTableCreate::ryanin ran successfully in 6ms
2022-04-28 01:56:43.102  INFO 8876 --- [main] liquibase.changelog                      : Table books created
2022-04-28 01:56:43.102  INFO 8876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-booksTableCreate::ryanin ran successfully in 14ms
2022-04-28 01:56:43.124  INFO 8876 --- [main] liquibase.changelog                      : Table commentaries created
2022-04-28 01:56:43.124  INFO 8876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-commentariesTableCreate::ryanin ran successfully in 19ms
2022-04-28 01:56:43.132  INFO 8876 --- [main] liquibase.changelog                      : Table users created
2022-04-28 01:56:43.132  INFO 8876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-usersTableCreate::ryanin ran successfully in 7ms
2022-04-28 01:56:43.145  INFO 8876 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-04-28 01:56:43.145  INFO 8876 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/authorsTableFill.csv' into table 'authors'
2022-04-28 01:56:43.146  INFO 8876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/authorsTableFill.xml::authorsTableFill::ryanin ran successfully in 12ms
2022-04-28 01:56:43.152  INFO 8876 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-04-28 01:56:43.152  INFO 8876 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/genresTableFill.csv' into table 'genres'
2022-04-28 01:56:43.153  INFO 8876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/genresTableFill.xml::genresTableFill::ryanin ran successfully in 5ms
2022-04-28 01:56:43.160  INFO 8876 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-04-28 01:56:43.160  INFO 8876 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/booksTableFill.csv' into table 'books'
2022-04-28 01:56:43.161  INFO 8876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/booksTableFill.xml::booksTableFill::ryanin ran successfully in 6ms
2022-04-28 01:56:43.167  INFO 8876 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-04-28 01:56:43.167  INFO 8876 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/commentariesTableFill.csv' into table 'commentaries'
2022-04-28 01:56:43.168  INFO 8876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/commentariesTableFill.xml::commentariesTableFill::ryanin ran successfully in 4ms
2022-04-28 01:56:43.175  INFO 8876 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-04-28 01:56:43.176  INFO 8876 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/usersTableFill.csv' into table 'users'
2022-04-28 01:56:43.176  INFO 8876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/usersTableFill.xml::userTableFill::ryanin ran successfully in 6ms
2022-04-28 01:56:43.178  INFO 8876 --- [main] liquibase.lockservice                    : Successfully released change log lock
2022-04-28 01:56:43.285  INFO 8876 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-04-28 01:56:43.365  INFO 8876 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.5.Final
2022-04-28 01:56:43.550  INFO 8876 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-04-28 01:56:43.666  INFO 8876 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-04-28 01:56:44.201  INFO 8876 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-04-28 01:56:44.211  INFO 8876 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-04-28 01:56:44.542  WARN 8876 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-04-28 01:56:44.834  INFO 8876 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-04-28 01:56:45.338  INFO 8876 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path '/actuator'
2022-04-28 01:56:45.394  INFO 8876 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-04-28 01:56:45.409  INFO 8876 --- [main] ru.otus.homework03.Main                  : Started Main in 6.083 seconds (JVM running for 7.232)
2022-04-28 01:56:45.577  INFO 8876 --- [RMI TCP Connection(3)-169.254.175.48] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-04-28 01:56:45.578  INFO 8876 --- [RMI TCP Connection(3)-169.254.175.48] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-04-28 01:56:45.580  INFO 8876 --- [RMI TCP Connection(3)-169.254.175.48] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2022-05-13 19:02:50.933  INFO 1788 --- [main] ru.otus.homework03.Main                  : Starting Main using Java 14.0.1 on DESKTOP-KDSIOVU with PID 1788 (C:\projects\otus_homework\homework03\target\classes started by yanin in C:\projects\otus_homework\homework03)
2022-05-13 19:02:50.936  INFO 1788 --- [main] ru.otus.homework03.Main                  : No active profile set, falling back to 1 default profile: "default"
2022-05-13 19:02:51.850  INFO 1788 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-05-13 19:02:51.924  INFO 1788 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 67 ms. Found 5 JPA repository interfaces.
2022-05-13 19:02:52.340  INFO 1788 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-05-13 19:02:52.347  INFO 1788 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-05-13 19:02:52.347  INFO 1788 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-05-13 19:02:52.455  INFO 1788 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-05-13 19:02:52.456  INFO 1788 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1472 ms
2022-05-13 19:02:52.532  INFO 1788 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-05-13 19:02:52.596  INFO 1788 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-05-13 19:02:52.604  INFO 1788 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2022-05-13 19:02:52.762  INFO 1788 --- [main] liquibase.database                       : Set default schema name to PUBLIC
2022-05-13 19:02:52.883  INFO 1788 --- [main] liquibase.lockservice                    : Successfully acquired change log lock
2022-05-13 19:02:52.900  INFO 1788 --- [main] liquibase.changelog                      : Reading resource: db/changelog/1.0/2022-03-01--0001.xml
2022-05-13 19:02:53.229  INFO 1788 --- [main] liquibase.changelog                      : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2022-05-13 19:02:53.233  INFO 1788 --- [main] liquibase.changelog                      : Reading from PUBLIC.DATABASECHANGELOG
2022-05-13 19:02:53.307  INFO 1788 --- [main] liquibase.changelog                      : Table authors created
2022-05-13 19:02:53.308  INFO 1788 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-authorsTableCreate::ryanin ran successfully in 21ms
2022-05-13 19:02:53.322  INFO 1788 --- [main] liquibase.changelog                      : Table genres created
2022-05-13 19:02:53.322  INFO 1788 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-genresTableCreate::ryanin ran successfully in 6ms
2022-05-13 19:02:53.335  INFO 1788 --- [main] liquibase.changelog                      : Table books created
2022-05-13 19:02:53.336  INFO 1788 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-booksTableCreate::ryanin ran successfully in 13ms
2022-05-13 19:02:53.344  INFO 1788 --- [main] liquibase.changelog                      : Table commentaries created
2022-05-13 19:02:53.345  INFO 1788 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-commentariesTableCreate::ryanin ran successfully in 8ms
2022-05-13 19:02:53.353  INFO 1788 --- [main] liquibase.changelog                      : Table users created
2022-05-13 19:02:53.353  INFO 1788 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-usersTableCreate::ryanin ran successfully in 7ms
2022-05-13 19:02:53.361  INFO 1788 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:02:53.361  INFO 1788 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/authorsTableFill.csv' into table 'authors'
2022-05-13 19:02:53.362  INFO 1788 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/authorsTableFill.xml::authorsTableFill::ryanin ran successfully in 8ms
2022-05-13 19:02:53.366  INFO 1788 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:02:53.366  INFO 1788 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/genresTableFill.csv' into table 'genres'
2022-05-13 19:02:53.367  INFO 1788 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/genresTableFill.xml::genresTableFill::ryanin ran successfully in 3ms
2022-05-13 19:02:53.382  INFO 1788 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:02:53.382  INFO 1788 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/booksTableFill.csv' into table 'books'
2022-05-13 19:02:53.382  INFO 1788 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/booksTableFill.xml::booksTableFill::ryanin ran successfully in 14ms
2022-05-13 19:02:53.388  INFO 1788 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:02:53.388  INFO 1788 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/commentariesTableFill.csv' into table 'commentaries'
2022-05-13 19:02:53.388  INFO 1788 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/commentariesTableFill.xml::commentariesTableFill::ryanin ran successfully in 4ms
2022-05-13 19:02:53.393  INFO 1788 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:02:53.393  INFO 1788 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/usersTableFill.csv' into table 'users'
2022-05-13 19:02:53.393  INFO 1788 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/usersTableFill.xml::userTableFill::ryanin ran successfully in 4ms
2022-05-13 19:02:53.395  INFO 1788 --- [main] liquibase.lockservice                    : Successfully released change log lock
2022-05-13 19:02:53.471  INFO 1788 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-05-13 19:02:53.511  INFO 1788 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.5.Final
2022-05-13 19:02:53.609  INFO 1788 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-05-13 19:02:53.683  INFO 1788 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-05-13 19:02:54.072  INFO 1788 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-05-13 19:02:54.079  INFO 1788 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 19:02:54.319  WARN 1788 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-05-13 19:02:54.579  INFO 1788 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-05-13 19:02:54.990  INFO 1788 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path '/actuator'
2022-05-13 19:02:55.047  WARN 1788 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'org.springframework.kafka.config.internalKafkaListenerEndpointRegistry'; nested exception is java.lang.IllegalStateException: No group.id found in consumer config, container properties, or @KafkaListener annotation; a group.id is required when group management is used.
2022-05-13 19:02:55.051  INFO 1788 --- [main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 19:02:55.053  INFO 1788 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-05-13 19:02:55.056  INFO 1788 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-05-13 19:02:55.057  INFO 1788 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2022-05-13 19:02:55.070  INFO 1788 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2022-05-13 19:02:55.089 ERROR 1788 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.context.ApplicationContextException: Failed to start bean 'org.springframework.kafka.config.internalKafkaListenerEndpointRegistry'; nested exception is java.lang.IllegalStateException: No group.id found in consumer config, container properties, or @KafkaListener annotation; a group.id is required when group management is used.
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:181) ~[spring-context-5.3.16.jar:5.3.16]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.16.jar:5.3.16]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.16.jar:5.3.16]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.16.jar:5.3.16]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.16.jar:5.3.16]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:935) ~[spring-context-5.3.16.jar:5.3.16]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.16.jar:5.3.16]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:145) ~[spring-boot-2.6.4.jar:2.6.4]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:740) ~[spring-boot-2.6.4.jar:2.6.4]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:415) ~[spring-boot-2.6.4.jar:2.6.4]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:303) ~[spring-boot-2.6.4.jar:2.6.4]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1312) ~[spring-boot-2.6.4.jar:2.6.4]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1301) ~[spring-boot-2.6.4.jar:2.6.4]
	at ru.otus.homework03.Main.main(Main.java:13) ~[classes/:na]
Caused by: java.lang.IllegalStateException: No group.id found in consumer config, container properties, or @KafkaListener annotation; a group.id is required when group management is used.
	at org.springframework.util.Assert.state(Assert.java:76) ~[spring-core-5.3.16.jar:5.3.16]
	at org.springframework.kafka.listener.AbstractMessageListenerContainer.checkGroupId(AbstractMessageListenerContainer.java:525) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.AbstractMessageListenerContainer.start(AbstractMessageListenerContainer.java:461) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.config.KafkaListenerEndpointRegistry.startIfNecessary(KafkaListenerEndpointRegistry.java:331) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.config.KafkaListenerEndpointRegistry.start(KafkaListenerEndpointRegistry.java:276) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.16.jar:5.3.16]
	... 14 common frames omitted

2022-05-13 19:04:09.762  INFO 19016 --- [main] ru.otus.homework03.Main                  : Starting Main using Java 14.0.1 on DESKTOP-KDSIOVU with PID 19016 (C:\projects\otus_homework\homework03\target\classes started by yanin in C:\projects\otus_homework\homework03)
2022-05-13 19:04:09.765  INFO 19016 --- [main] ru.otus.homework03.Main                  : No active profile set, falling back to 1 default profile: "default"
2022-05-13 19:04:10.783  INFO 19016 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-05-13 19:04:10.868  INFO 19016 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 76 ms. Found 5 JPA repository interfaces.
2022-05-13 19:04:11.350  INFO 19016 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-05-13 19:04:11.358  INFO 19016 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-05-13 19:04:11.358  INFO 19016 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-05-13 19:04:11.467  INFO 19016 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-05-13 19:04:11.467  INFO 19016 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1662 ms
2022-05-13 19:04:11.556  INFO 19016 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-05-13 19:04:11.632  INFO 19016 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-05-13 19:04:11.641  INFO 19016 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2022-05-13 19:04:11.824  INFO 19016 --- [main] liquibase.database                       : Set default schema name to PUBLIC
2022-05-13 19:04:11.953  INFO 19016 --- [main] liquibase.lockservice                    : Successfully acquired change log lock
2022-05-13 19:04:11.969  INFO 19016 --- [main] liquibase.changelog                      : Reading resource: db/changelog/1.0/2022-03-01--0001.xml
2022-05-13 19:04:12.335  INFO 19016 --- [main] liquibase.changelog                      : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2022-05-13 19:04:12.338  INFO 19016 --- [main] liquibase.changelog                      : Reading from PUBLIC.DATABASECHANGELOG
2022-05-13 19:04:12.410  INFO 19016 --- [main] liquibase.changelog                      : Table authors created
2022-05-13 19:04:12.411  INFO 19016 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-authorsTableCreate::ryanin ran successfully in 22ms
2022-05-13 19:04:12.426  INFO 19016 --- [main] liquibase.changelog                      : Table genres created
2022-05-13 19:04:12.427  INFO 19016 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-genresTableCreate::ryanin ran successfully in 7ms
2022-05-13 19:04:12.443  INFO 19016 --- [main] liquibase.changelog                      : Table books created
2022-05-13 19:04:12.443  INFO 19016 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-booksTableCreate::ryanin ran successfully in 15ms
2022-05-13 19:04:12.453  INFO 19016 --- [main] liquibase.changelog                      : Table commentaries created
2022-05-13 19:04:12.454  INFO 19016 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-commentariesTableCreate::ryanin ran successfully in 10ms
2022-05-13 19:04:12.462  INFO 19016 --- [main] liquibase.changelog                      : Table users created
2022-05-13 19:04:12.462  INFO 19016 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-usersTableCreate::ryanin ran successfully in 7ms
2022-05-13 19:04:12.471  INFO 19016 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:04:12.472  INFO 19016 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/authorsTableFill.csv' into table 'authors'
2022-05-13 19:04:12.472  INFO 19016 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/authorsTableFill.xml::authorsTableFill::ryanin ran successfully in 9ms
2022-05-13 19:04:12.476  INFO 19016 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:04:12.477  INFO 19016 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/genresTableFill.csv' into table 'genres'
2022-05-13 19:04:12.477  INFO 19016 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/genresTableFill.xml::genresTableFill::ryanin ran successfully in 4ms
2022-05-13 19:04:12.482  INFO 19016 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:04:12.483  INFO 19016 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/booksTableFill.csv' into table 'books'
2022-05-13 19:04:12.483  INFO 19016 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/booksTableFill.xml::booksTableFill::ryanin ran successfully in 5ms
2022-05-13 19:04:12.502  INFO 19016 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:04:12.503  INFO 19016 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/commentariesTableFill.csv' into table 'commentaries'
2022-05-13 19:04:12.503  INFO 19016 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/commentariesTableFill.xml::commentariesTableFill::ryanin ran successfully in 18ms
2022-05-13 19:04:12.509  INFO 19016 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:04:12.509  INFO 19016 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/usersTableFill.csv' into table 'users'
2022-05-13 19:04:12.509  INFO 19016 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/usersTableFill.xml::userTableFill::ryanin ran successfully in 4ms
2022-05-13 19:04:12.511  INFO 19016 --- [main] liquibase.lockservice                    : Successfully released change log lock
2022-05-13 19:04:12.599  INFO 19016 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-05-13 19:04:12.649  INFO 19016 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.5.Final
2022-05-13 19:04:12.756  INFO 19016 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-05-13 19:04:12.840  INFO 19016 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-05-13 19:04:13.278  INFO 19016 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-05-13 19:04:13.285  INFO 19016 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 19:04:13.531  WARN 19016 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-05-13 19:04:13.804  INFO 19016 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-05-13 19:04:14.277  INFO 19016 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path '/actuator'
2022-05-13 19:04:14.369  INFO 19016 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-1-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = 1
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2022-05-13 19:04:14.483  INFO 19016 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 19:04:14.483  INFO 19016 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 19:04:14.483  INFO 19016 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652457854481
2022-05-13 19:04:14.507  INFO 19016 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-1-1, groupId=1] Subscribed to topic(s): msg
2022-05-13 19:04:14.531  INFO 19016 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-05-13 19:04:14.546  INFO 19016 --- [main] ru.otus.homework03.Main                  : Started Main in 5.193 seconds (JVM running for 5.768)
2022-05-13 19:04:14.650  INFO 19016 --- [RMI TCP Connection(1)-169.254.74.73] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-05-13 19:04:14.650  INFO 19016 --- [RMI TCP Connection(1)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-05-13 19:04:14.652  INFO 19016 --- [RMI TCP Connection(1)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2022-05-13 19:04:16.954  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:16.954  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:04:19.096  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:19.097  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:04:21.284  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:21.285  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:04:23.540  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:23.540  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:04:26.075  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:26.076  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:04:28.962  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:28.963  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:04:32.043  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:32.044  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:04:35.186  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:35.186  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:04:38.215  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:38.216  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:04:41.126  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:41.127  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:04:43.865  WARN 19016 --- [http-nio-8080-exec-2] .w.s.m.s.DefaultHandlerExceptionResolver : Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'GET' not supported]
2022-05-13 19:04:44.143  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:44.143  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:04:47.276  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:47.277  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:04:50.172  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:50.173  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:04:53.113  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:04:53.114  WARN 19016 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:04.003  INFO 19248 --- [main] ru.otus.homework03.Main                  : Starting Main using Java 14.0.1 on DESKTOP-KDSIOVU with PID 19248 (C:\projects\otus_homework\homework03\target\classes started by yanin in C:\projects\otus_homework\homework03)
2022-05-13 19:05:04.005  INFO 19248 --- [main] ru.otus.homework03.Main                  : No active profile set, falling back to 1 default profile: "default"
2022-05-13 19:05:04.846  INFO 19248 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-05-13 19:05:04.917  INFO 19248 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 62 ms. Found 5 JPA repository interfaces.
2022-05-13 19:05:05.335  INFO 19248 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-05-13 19:05:05.342  INFO 19248 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-05-13 19:05:05.343  INFO 19248 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-05-13 19:05:05.460  INFO 19248 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-05-13 19:05:05.460  INFO 19248 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1419 ms
2022-05-13 19:05:05.544  INFO 19248 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-05-13 19:05:05.615  INFO 19248 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-05-13 19:05:05.622  INFO 19248 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2022-05-13 19:05:05.796  INFO 19248 --- [main] liquibase.database                       : Set default schema name to PUBLIC
2022-05-13 19:05:05.917  INFO 19248 --- [main] liquibase.lockservice                    : Successfully acquired change log lock
2022-05-13 19:05:05.937  INFO 19248 --- [main] liquibase.changelog                      : Reading resource: db/changelog/1.0/2022-03-01--0001.xml
2022-05-13 19:05:06.264  INFO 19248 --- [main] liquibase.changelog                      : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2022-05-13 19:05:06.266  INFO 19248 --- [main] liquibase.changelog                      : Reading from PUBLIC.DATABASECHANGELOG
2022-05-13 19:05:06.350  INFO 19248 --- [main] liquibase.changelog                      : Table authors created
2022-05-13 19:05:06.350  INFO 19248 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-authorsTableCreate::ryanin ran successfully in 19ms
2022-05-13 19:05:06.365  INFO 19248 --- [main] liquibase.changelog                      : Table genres created
2022-05-13 19:05:06.365  INFO 19248 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-genresTableCreate::ryanin ran successfully in 7ms
2022-05-13 19:05:06.379  INFO 19248 --- [main] liquibase.changelog                      : Table books created
2022-05-13 19:05:06.379  INFO 19248 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-booksTableCreate::ryanin ran successfully in 13ms
2022-05-13 19:05:06.389  INFO 19248 --- [main] liquibase.changelog                      : Table commentaries created
2022-05-13 19:05:06.389  INFO 19248 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-commentariesTableCreate::ryanin ran successfully in 8ms
2022-05-13 19:05:06.397  INFO 19248 --- [main] liquibase.changelog                      : Table users created
2022-05-13 19:05:06.397  INFO 19248 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-usersTableCreate::ryanin ran successfully in 7ms
2022-05-13 19:05:06.417  INFO 19248 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:05:06.418  INFO 19248 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/authorsTableFill.csv' into table 'authors'
2022-05-13 19:05:06.418  INFO 19248 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/authorsTableFill.xml::authorsTableFill::ryanin ran successfully in 19ms
2022-05-13 19:05:06.422  INFO 19248 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:05:06.423  INFO 19248 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/genresTableFill.csv' into table 'genres'
2022-05-13 19:05:06.423  INFO 19248 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/genresTableFill.xml::genresTableFill::ryanin ran successfully in 4ms
2022-05-13 19:05:06.428  INFO 19248 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:05:06.429  INFO 19248 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/booksTableFill.csv' into table 'books'
2022-05-13 19:05:06.429  INFO 19248 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/booksTableFill.xml::booksTableFill::ryanin ran successfully in 5ms
2022-05-13 19:05:06.433  INFO 19248 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:05:06.434  INFO 19248 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/commentariesTableFill.csv' into table 'commentaries'
2022-05-13 19:05:06.434  INFO 19248 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/commentariesTableFill.xml::commentariesTableFill::ryanin ran successfully in 4ms
2022-05-13 19:05:06.439  INFO 19248 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:05:06.439  INFO 19248 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/usersTableFill.csv' into table 'users'
2022-05-13 19:05:06.439  INFO 19248 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/usersTableFill.xml::userTableFill::ryanin ran successfully in 4ms
2022-05-13 19:05:06.441  INFO 19248 --- [main] liquibase.lockservice                    : Successfully released change log lock
2022-05-13 19:05:06.522  INFO 19248 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-05-13 19:05:06.564  INFO 19248 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.5.Final
2022-05-13 19:05:06.657  INFO 19248 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-05-13 19:05:06.735  INFO 19248 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-05-13 19:05:07.109  INFO 19248 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-05-13 19:05:07.117  INFO 19248 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 19:05:07.417  WARN 19248 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-05-13 19:05:07.687  INFO 19248 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-05-13 19:05:08.103  INFO 19248 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path '/actuator'
2022-05-13 19:05:08.178  INFO 19248 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-1-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = 1
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2022-05-13 19:05:08.236  INFO 19248 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 19:05:08.237  INFO 19248 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 19:05:08.237  INFO 19248 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652457908235
2022-05-13 19:05:08.247  INFO 19248 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-1-1, groupId=1] Subscribed to topic(s): msg
2022-05-13 19:05:08.263  INFO 19248 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-05-13 19:05:08.276  INFO 19248 --- [main] ru.otus.homework03.Main                  : Started Main in 4.65 seconds (JVM running for 5.264)
2022-05-13 19:05:08.821  INFO 19248 --- [RMI TCP Connection(5)-169.254.74.73] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-05-13 19:05:08.822  INFO 19248 --- [RMI TCP Connection(5)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-05-13 19:05:08.823  INFO 19248 --- [RMI TCP Connection(5)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2022-05-13 19:05:10.463  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:10.464  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:12.608  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:12.610  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:14.823  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:14.824  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:17.094  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:17.095  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:19.503  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:19.504  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:22.508  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:22.509  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:25.401  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:25.402  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:28.443  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:28.444  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:31.456  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:31.457  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:34.391  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:34.392  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:37.607  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:37.608  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:40.746  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:40.747  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:43.898  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:43.899  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:46.878  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:46.880  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:50.088  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:50.088  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:05:52.990  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Broker may not be available.
2022-05-13 19:05:52.991  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2022-05-13 19:06:03.851  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Error while fetching metadata with correlation id 9 : {msg=LEADER_NOT_AVAILABLE}
2022-05-13 19:06:03.852  INFO 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-1-1, groupId=1] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 19:06:03.955  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Error while fetching metadata with correlation id 11 : {msg=LEADER_NOT_AVAILABLE}
2022-05-13 19:06:04.063  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Error while fetching metadata with correlation id 13 : {msg=LEADER_NOT_AVAILABLE}
2022-05-13 19:06:04.174  WARN 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.NetworkClient   : [Consumer clientId=consumer-1-1, groupId=1] Error while fetching metadata with correlation id 15 : {msg=LEADER_NOT_AVAILABLE}
2022-05-13 19:06:04.287  INFO 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Discovered group coordinator DESKTOP-KDSIOVU:9092 (id: 2147483647 rack: null)
2022-05-13 19:06:04.290  INFO 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] (Re-)joining group
2022-05-13 19:06:04.313  INFO 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Request joining group due to: need to re-join with the given member-id
2022-05-13 19:06:04.314  INFO 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] (Re-)joining group
2022-05-13 19:06:23.221  WARN 19248 --- [http-nio-8080-exec-2] .w.s.m.s.DefaultHandlerExceptionResolver : Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'GET' not supported]
2022-05-13 19:06:47.018  INFO 19248 --- [http-nio-8080-exec-3] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2022-05-13 19:06:47.037  INFO 19248 --- [http-nio-8080-exec-3] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 19:06:47.038  INFO 19248 --- [http-nio-8080-exec-3] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 19:06:47.038  INFO 19248 --- [http-nio-8080-exec-3] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652458007037
2022-05-13 19:06:47.044  INFO 19248 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 19:06:49.250  INFO 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Successfully joined group with generation Generation{generationId=6, memberId='consumer-1-1-598b415a-bdde-450c-a83f-4afa4be1aaf9', protocol='range'}
2022-05-13 19:06:49.255  INFO 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Finished assignment for group at generation 6: {consumer-1-1-598b415a-bdde-450c-a83f-4afa4be1aaf9=Assignment(partitions=[msg-0])}
2022-05-13 19:06:49.288  INFO 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Successfully synced group in generation Generation{generationId=6, memberId='consumer-1-1-598b415a-bdde-450c-a83f-4afa4be1aaf9', protocol='range'}
2022-05-13 19:06:49.288  INFO 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Notifying assignor about the new Assignment(partitions=[msg-0])
2022-05-13 19:06:49.292  INFO 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Adding newly assigned partitions: msg-0
2022-05-13 19:06:49.307  INFO 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Setting offset for partition msg-0 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[DESKTOP-KDSIOVU:9092 (id: 0 rack: null)], epoch=0}}
2022-05-13 19:06:49.308  INFO 19248 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : 1: partitions assigned: [msg-0]
2022-05-13 19:09:06.054  INFO 616 --- [main] ru.otus.homework03.Main                  : Starting Main using Java 14.0.1 on DESKTOP-KDSIOVU with PID 616 (C:\projects\otus_homework\homework03\target\classes started by yanin in C:\projects\otus_homework\homework03)
2022-05-13 19:09:06.059  INFO 616 --- [main] ru.otus.homework03.Main                  : No active profile set, falling back to 1 default profile: "default"
2022-05-13 19:09:07.180  INFO 616 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-05-13 19:09:07.297  INFO 616 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 101 ms. Found 5 JPA repository interfaces.
2022-05-13 19:09:07.888  INFO 616 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-05-13 19:09:07.895  INFO 616 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-05-13 19:09:07.895  INFO 616 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-05-13 19:09:07.997  INFO 616 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-05-13 19:09:07.998  INFO 616 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1876 ms
2022-05-13 19:09:08.071  INFO 616 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-05-13 19:09:08.137  INFO 616 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-05-13 19:09:08.144  INFO 616 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2022-05-13 19:09:08.303  INFO 616 --- [main] liquibase.database                       : Set default schema name to PUBLIC
2022-05-13 19:09:08.441  INFO 616 --- [main] liquibase.lockservice                    : Successfully acquired change log lock
2022-05-13 19:09:08.456  INFO 616 --- [main] liquibase.changelog                      : Reading resource: db/changelog/1.0/2022-03-01--0001.xml
2022-05-13 19:09:08.791  INFO 616 --- [main] liquibase.changelog                      : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2022-05-13 19:09:08.794  INFO 616 --- [main] liquibase.changelog                      : Reading from PUBLIC.DATABASECHANGELOG
2022-05-13 19:09:08.861  INFO 616 --- [main] liquibase.changelog                      : Table authors created
2022-05-13 19:09:08.862  INFO 616 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-authorsTableCreate::ryanin ran successfully in 21ms
2022-05-13 19:09:08.878  INFO 616 --- [main] liquibase.changelog                      : Table genres created
2022-05-13 19:09:08.878  INFO 616 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-genresTableCreate::ryanin ran successfully in 9ms
2022-05-13 19:09:08.892  INFO 616 --- [main] liquibase.changelog                      : Table books created
2022-05-13 19:09:08.892  INFO 616 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-booksTableCreate::ryanin ran successfully in 12ms
2022-05-13 19:09:08.901  INFO 616 --- [main] liquibase.changelog                      : Table commentaries created
2022-05-13 19:09:08.902  INFO 616 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-commentariesTableCreate::ryanin ran successfully in 8ms
2022-05-13 19:09:08.910  INFO 616 --- [main] liquibase.changelog                      : Table users created
2022-05-13 19:09:08.910  INFO 616 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-usersTableCreate::ryanin ran successfully in 7ms
2022-05-13 19:09:08.919  INFO 616 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:09:08.919  INFO 616 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/authorsTableFill.csv' into table 'authors'
2022-05-13 19:09:08.920  INFO 616 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/authorsTableFill.xml::authorsTableFill::ryanin ran successfully in 8ms
2022-05-13 19:09:08.924  INFO 616 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:09:08.924  INFO 616 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/genresTableFill.csv' into table 'genres'
2022-05-13 19:09:08.925  INFO 616 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/genresTableFill.xml::genresTableFill::ryanin ran successfully in 4ms
2022-05-13 19:09:08.930  INFO 616 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:09:08.930  INFO 616 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/booksTableFill.csv' into table 'books'
2022-05-13 19:09:08.930  INFO 616 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/booksTableFill.xml::booksTableFill::ryanin ran successfully in 4ms
2022-05-13 19:09:08.934  INFO 616 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:09:08.935  INFO 616 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/commentariesTableFill.csv' into table 'commentaries'
2022-05-13 19:09:08.935  INFO 616 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/commentariesTableFill.xml::commentariesTableFill::ryanin ran successfully in 4ms
2022-05-13 19:09:08.939  INFO 616 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 19:09:08.940  INFO 616 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/usersTableFill.csv' into table 'users'
2022-05-13 19:09:08.940  INFO 616 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/usersTableFill.xml::userTableFill::ryanin ran successfully in 4ms
2022-05-13 19:09:08.941  INFO 616 --- [main] liquibase.lockservice                    : Successfully released change log lock
2022-05-13 19:09:09.020  INFO 616 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-05-13 19:09:09.059  INFO 616 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.5.Final
2022-05-13 19:09:09.163  INFO 616 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-05-13 19:09:09.243  INFO 616 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-05-13 19:09:09.646  INFO 616 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-05-13 19:09:09.653  INFO 616 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 19:09:09.927  WARN 616 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-05-13 19:09:10.187  INFO 616 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-05-13 19:09:10.651  INFO 616 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path '/actuator'
2022-05-13 19:09:10.731  INFO 616 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-1-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = 1
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2022-05-13 19:09:10.803  INFO 616 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 19:09:10.804  INFO 616 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 19:09:10.804  INFO 616 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652458150802
2022-05-13 19:09:10.814  INFO 616 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-1-1, groupId=1] Subscribed to topic(s): msg
2022-05-13 19:09:10.830  INFO 616 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-05-13 19:09:10.842  INFO 616 --- [main] ru.otus.homework03.Main                  : Started Main in 5.192 seconds (JVM running for 5.761)
2022-05-13 19:09:10.936  INFO 616 --- [RMI TCP Connection(7)-169.254.74.73] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-05-13 19:09:10.937  INFO 616 --- [RMI TCP Connection(7)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-05-13 19:09:10.940  INFO 616 --- [RMI TCP Connection(7)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
2022-05-13 19:09:11.075  INFO 616 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-1-1, groupId=1] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 19:09:11.076  INFO 616 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Discovered group coordinator DESKTOP-KDSIOVU:9092 (id: 2147483647 rack: null)
2022-05-13 19:09:11.078  INFO 616 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] (Re-)joining group
2022-05-13 19:09:11.089  INFO 616 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Request joining group due to: need to re-join with the given member-id
2022-05-13 19:09:11.090  INFO 616 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] (Re-)joining group
2022-05-13 19:09:17.537  INFO 616 --- [http-nio-8080-exec-1] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2022-05-13 19:09:17.552  INFO 616 --- [http-nio-8080-exec-1] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 19:09:17.552  INFO 616 --- [http-nio-8080-exec-1] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 19:09:17.553  INFO 616 --- [http-nio-8080-exec-1] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652458157552
2022-05-13 19:09:17.557  INFO 616 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 19:09:43.583  INFO 616 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Successfully joined group with generation Generation{generationId=7, memberId='consumer-1-1-38a1a232-da65-4ade-a1d0-518167744cbb', protocol='range'}
2022-05-13 19:09:43.587  INFO 616 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Finished assignment for group at generation 7: {consumer-1-1-38a1a232-da65-4ade-a1d0-518167744cbb=Assignment(partitions=[msg-0])}
2022-05-13 19:09:43.600  INFO 616 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Successfully synced group in generation Generation{generationId=7, memberId='consumer-1-1-38a1a232-da65-4ade-a1d0-518167744cbb', protocol='range'}
2022-05-13 19:09:43.601  INFO 616 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Notifying assignor about the new Assignment(partitions=[msg-0])
2022-05-13 19:09:43.606  INFO 616 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Adding newly assigned partitions: msg-0
2022-05-13 19:09:43.622  INFO 616 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-1-1, groupId=1] Setting offset for partition msg-0 to the committed offset FetchPosition{offset=7, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[DESKTOP-KDSIOVU:9092 (id: 0 rack: null)], epoch=0}}
2022-05-13 19:09:43.623  INFO 616 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : 1: partitions assigned: [msg-0]
2022-05-13 22:06:57.092  INFO 12928 --- [main] ru.otus.homework03.Main                  : Starting Main using Java 14.0.1 on DESKTOP-KDSIOVU with PID 12928 (C:\projects\otus_homework\homework03\target\classes started by yanin in C:\projects\otus_homework\homework03)
2022-05-13 22:06:57.094  INFO 12928 --- [main] ru.otus.homework03.Main                  : No active profile set, falling back to 1 default profile: "default"
2022-05-13 22:06:58.009  INFO 12928 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-05-13 22:06:58.079  INFO 12928 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 62 ms. Found 5 JPA repository interfaces.
2022-05-13 22:06:58.528  INFO 12928 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-05-13 22:06:58.535  INFO 12928 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-05-13 22:06:58.536  INFO 12928 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-05-13 22:06:58.645  INFO 12928 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-05-13 22:06:58.645  INFO 12928 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1506 ms
2022-05-13 22:06:58.730  INFO 12928 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-05-13 22:06:58.808  INFO 12928 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-05-13 22:06:58.815  INFO 12928 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2022-05-13 22:06:58.995  INFO 12928 --- [main] liquibase.database                       : Set default schema name to PUBLIC
2022-05-13 22:06:59.127  INFO 12928 --- [main] liquibase.lockservice                    : Successfully acquired change log lock
2022-05-13 22:06:59.143  INFO 12928 --- [main] liquibase.changelog                      : Reading resource: db/changelog/1.0/2022-03-01--0001.xml
2022-05-13 22:06:59.517  INFO 12928 --- [main] liquibase.changelog                      : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2022-05-13 22:06:59.520  INFO 12928 --- [main] liquibase.changelog                      : Reading from PUBLIC.DATABASECHANGELOG
2022-05-13 22:06:59.595  INFO 12928 --- [main] liquibase.changelog                      : Table authors created
2022-05-13 22:06:59.596  INFO 12928 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-authorsTableCreate::ryanin ran successfully in 24ms
2022-05-13 22:06:59.612  INFO 12928 --- [main] liquibase.changelog                      : Table genres created
2022-05-13 22:06:59.612  INFO 12928 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-genresTableCreate::ryanin ran successfully in 8ms
2022-05-13 22:06:59.629  INFO 12928 --- [main] liquibase.changelog                      : Table books created
2022-05-13 22:06:59.629  INFO 12928 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-booksTableCreate::ryanin ran successfully in 16ms
2022-05-13 22:06:59.640  INFO 12928 --- [main] liquibase.changelog                      : Table commentaries created
2022-05-13 22:06:59.641  INFO 12928 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-commentariesTableCreate::ryanin ran successfully in 10ms
2022-05-13 22:06:59.650  INFO 12928 --- [main] liquibase.changelog                      : Table users created
2022-05-13 22:06:59.650  INFO 12928 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-usersTableCreate::ryanin ran successfully in 8ms
2022-05-13 22:06:59.659  INFO 12928 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:06:59.660  INFO 12928 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/authorsTableFill.csv' into table 'authors'
2022-05-13 22:06:59.660  INFO 12928 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/authorsTableFill.xml::authorsTableFill::ryanin ran successfully in 9ms
2022-05-13 22:06:59.664  INFO 12928 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:06:59.665  INFO 12928 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/genresTableFill.csv' into table 'genres'
2022-05-13 22:06:59.665  INFO 12928 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/genresTableFill.xml::genresTableFill::ryanin ran successfully in 4ms
2022-05-13 22:06:59.670  INFO 12928 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:06:59.670  INFO 12928 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/booksTableFill.csv' into table 'books'
2022-05-13 22:06:59.671  INFO 12928 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/booksTableFill.xml::booksTableFill::ryanin ran successfully in 4ms
2022-05-13 22:06:59.676  INFO 12928 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:06:59.676  INFO 12928 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/commentariesTableFill.csv' into table 'commentaries'
2022-05-13 22:06:59.676  INFO 12928 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/commentariesTableFill.xml::commentariesTableFill::ryanin ran successfully in 4ms
2022-05-13 22:06:59.682  INFO 12928 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:06:59.682  INFO 12928 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/usersTableFill.csv' into table 'users'
2022-05-13 22:06:59.682  INFO 12928 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/usersTableFill.xml::userTableFill::ryanin ran successfully in 4ms
2022-05-13 22:06:59.684  INFO 12928 --- [main] liquibase.lockservice                    : Successfully released change log lock
2022-05-13 22:06:59.764  INFO 12928 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-05-13 22:06:59.805  INFO 12928 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.5.Final
2022-05-13 22:06:59.929  INFO 12928 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-05-13 22:07:00.020  INFO 12928 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-05-13 22:07:00.439  INFO 12928 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-05-13 22:07:00.447  INFO 12928 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 22:07:00.761  WARN 12928 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-05-13 22:07:01.035  INFO 12928 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-05-13 22:07:01.481  INFO 12928 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path '/actuator'
2022-05-13 22:07:01.551  INFO 12928 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-05-13 22:07:01.599  INFO 12928 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:07:01.600  INFO 12928 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:07:01.600  INFO 12928 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652468821598
2022-05-13 22:07:02.048  INFO 12928 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-05-13 22:07:02.052  INFO 12928 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-05-13 22:07:02.052  INFO 12928 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-05-13 22:07:02.052  INFO 12928 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-05-13 22:07:02.056  WARN 12928 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'org.springframework.kafka.config.internalKafkaListenerEndpointRegistry'; nested exception is java.lang.IllegalStateException: No group.id found in consumer config, container properties, or @KafkaListener annotation; a group.id is required when group management is used.
2022-05-13 22:07:02.060  INFO 12928 --- [main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 22:07:02.062  INFO 12928 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-05-13 22:07:02.065  INFO 12928 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-05-13 22:07:02.067  INFO 12928 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2022-05-13 22:07:02.081  INFO 12928 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2022-05-13 22:07:02.097 ERROR 12928 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.context.ApplicationContextException: Failed to start bean 'org.springframework.kafka.config.internalKafkaListenerEndpointRegistry'; nested exception is java.lang.IllegalStateException: No group.id found in consumer config, container properties, or @KafkaListener annotation; a group.id is required when group management is used.
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:181) ~[spring-context-5.3.16.jar:5.3.16]
	at org.springframework.context.support.DefaultLifecycleProcessor.access$200(DefaultLifecycleProcessor.java:54) ~[spring-context-5.3.16.jar:5.3.16]
	at org.springframework.context.support.DefaultLifecycleProcessor$LifecycleGroup.start(DefaultLifecycleProcessor.java:356) ~[spring-context-5.3.16.jar:5.3.16]
	at java.base/java.lang.Iterable.forEach(Iterable.java:75) ~[na:na]
	at org.springframework.context.support.DefaultLifecycleProcessor.startBeans(DefaultLifecycleProcessor.java:155) ~[spring-context-5.3.16.jar:5.3.16]
	at org.springframework.context.support.DefaultLifecycleProcessor.onRefresh(DefaultLifecycleProcessor.java:123) ~[spring-context-5.3.16.jar:5.3.16]
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:935) ~[spring-context-5.3.16.jar:5.3.16]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:586) ~[spring-context-5.3.16.jar:5.3.16]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:145) ~[spring-boot-2.6.4.jar:2.6.4]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:740) ~[spring-boot-2.6.4.jar:2.6.4]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:415) ~[spring-boot-2.6.4.jar:2.6.4]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:303) ~[spring-boot-2.6.4.jar:2.6.4]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1312) ~[spring-boot-2.6.4.jar:2.6.4]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1301) ~[spring-boot-2.6.4.jar:2.6.4]
	at ru.otus.homework03.Main.main(Main.java:13) ~[classes/:na]
Caused by: java.lang.IllegalStateException: No group.id found in consumer config, container properties, or @KafkaListener annotation; a group.id is required when group management is used.
	at org.springframework.util.Assert.state(Assert.java:76) ~[spring-core-5.3.16.jar:5.3.16]
	at org.springframework.kafka.listener.AbstractMessageListenerContainer.checkGroupId(AbstractMessageListenerContainer.java:525) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.AbstractMessageListenerContainer.start(AbstractMessageListenerContainer.java:461) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.config.KafkaListenerEndpointRegistry.startIfNecessary(KafkaListenerEndpointRegistry.java:331) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.config.KafkaListenerEndpointRegistry.start(KafkaListenerEndpointRegistry.java:276) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.context.support.DefaultLifecycleProcessor.doStart(DefaultLifecycleProcessor.java:178) ~[spring-context-5.3.16.jar:5.3.16]
	... 14 common frames omitted

2022-05-13 22:07:42.244  INFO 12408 --- [main] ru.otus.homework03.Main                  : Starting Main using Java 14.0.1 on DESKTOP-KDSIOVU with PID 12408 (C:\projects\otus_homework\homework03\target\classes started by yanin in C:\projects\otus_homework\homework03)
2022-05-13 22:07:42.246  INFO 12408 --- [main] ru.otus.homework03.Main                  : No active profile set, falling back to 1 default profile: "default"
2022-05-13 22:07:43.134  INFO 12408 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-05-13 22:07:43.202  INFO 12408 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 60 ms. Found 5 JPA repository interfaces.
2022-05-13 22:07:43.702  INFO 12408 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-05-13 22:07:43.716  INFO 12408 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-05-13 22:07:43.717  INFO 12408 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-05-13 22:07:43.835  INFO 12408 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-05-13 22:07:43.835  INFO 12408 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1551 ms
2022-05-13 22:07:43.918  INFO 12408 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-05-13 22:07:43.991  INFO 12408 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-05-13 22:07:43.998  INFO 12408 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2022-05-13 22:07:44.169  INFO 12408 --- [main] liquibase.database                       : Set default schema name to PUBLIC
2022-05-13 22:07:44.296  INFO 12408 --- [main] liquibase.lockservice                    : Successfully acquired change log lock
2022-05-13 22:07:44.314  INFO 12408 --- [main] liquibase.changelog                      : Reading resource: db/changelog/1.0/2022-03-01--0001.xml
2022-05-13 22:07:44.676  INFO 12408 --- [main] liquibase.changelog                      : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2022-05-13 22:07:44.679  INFO 12408 --- [main] liquibase.changelog                      : Reading from PUBLIC.DATABASECHANGELOG
2022-05-13 22:07:44.751  INFO 12408 --- [main] liquibase.changelog                      : Table authors created
2022-05-13 22:07:44.752  INFO 12408 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-authorsTableCreate::ryanin ran successfully in 22ms
2022-05-13 22:07:44.767  INFO 12408 --- [main] liquibase.changelog                      : Table genres created
2022-05-13 22:07:44.767  INFO 12408 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-genresTableCreate::ryanin ran successfully in 6ms
2022-05-13 22:07:44.782  INFO 12408 --- [main] liquibase.changelog                      : Table books created
2022-05-13 22:07:44.782  INFO 12408 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-booksTableCreate::ryanin ran successfully in 14ms
2022-05-13 22:07:44.792  INFO 12408 --- [main] liquibase.changelog                      : Table commentaries created
2022-05-13 22:07:44.793  INFO 12408 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-commentariesTableCreate::ryanin ran successfully in 10ms
2022-05-13 22:07:44.801  INFO 12408 --- [main] liquibase.changelog                      : Table users created
2022-05-13 22:07:44.802  INFO 12408 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-usersTableCreate::ryanin ran successfully in 8ms
2022-05-13 22:07:44.810  INFO 12408 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:07:44.811  INFO 12408 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/authorsTableFill.csv' into table 'authors'
2022-05-13 22:07:44.811  INFO 12408 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/authorsTableFill.xml::authorsTableFill::ryanin ran successfully in 8ms
2022-05-13 22:07:44.815  INFO 12408 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:07:44.816  INFO 12408 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/genresTableFill.csv' into table 'genres'
2022-05-13 22:07:44.816  INFO 12408 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/genresTableFill.xml::genresTableFill::ryanin ran successfully in 4ms
2022-05-13 22:07:44.821  INFO 12408 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:07:44.822  INFO 12408 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/booksTableFill.csv' into table 'books'
2022-05-13 22:07:44.822  INFO 12408 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/booksTableFill.xml::booksTableFill::ryanin ran successfully in 4ms
2022-05-13 22:07:44.827  INFO 12408 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:07:44.827  INFO 12408 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/commentariesTableFill.csv' into table 'commentaries'
2022-05-13 22:07:44.828  INFO 12408 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/commentariesTableFill.xml::commentariesTableFill::ryanin ran successfully in 3ms
2022-05-13 22:07:44.832  INFO 12408 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:07:44.833  INFO 12408 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/usersTableFill.csv' into table 'users'
2022-05-13 22:07:44.833  INFO 12408 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/usersTableFill.xml::userTableFill::ryanin ran successfully in 4ms
2022-05-13 22:07:44.835  INFO 12408 --- [main] liquibase.lockservice                    : Successfully released change log lock
2022-05-13 22:07:44.912  INFO 12408 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-05-13 22:07:44.979  INFO 12408 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.5.Final
2022-05-13 22:07:45.084  INFO 12408 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-05-13 22:07:45.169  INFO 12408 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-05-13 22:07:45.614  INFO 12408 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-05-13 22:07:45.628  INFO 12408 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 22:07:45.945  WARN 12408 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-05-13 22:07:46.208  INFO 12408 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-05-13 22:07:46.704  INFO 12408 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path '/actuator'
2022-05-13 22:07:46.772  INFO 12408 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-05-13 22:07:46.812  INFO 12408 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:07:46.813  INFO 12408 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:07:46.813  INFO 12408 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652468866811
2022-05-13 22:07:47.086  INFO 12408 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-05-13 22:07:47.090  INFO 12408 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-05-13 22:07:47.091  INFO 12408 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-05-13 22:07:47.091  INFO 12408 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-05-13 22:07:47.109  INFO 12408 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-testGroupId-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = testGroupId
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2022-05-13 22:07:47.133  INFO 12408 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:07:47.133  INFO 12408 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:07:47.133  INFO 12408 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652468867133
2022-05-13 22:07:47.134  INFO 12408 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Subscribed to topic(s): test
2022-05-13 22:07:47.149  INFO 12408 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-05-13 22:07:47.154  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 22:07:47.155  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Discovered group coordinator DESKTOP-KDSIOVU:9092 (id: 2147483647 rack: null)
2022-05-13 22:07:47.157  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:07:47.163  INFO 12408 --- [main] ru.otus.homework03.Main                  : Started Main in 5.288 seconds (JVM running for 5.839)
2022-05-13 22:07:47.169  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Request joining group due to: need to re-join with the given member-id
2022-05-13 22:07:47.169  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:07:47.174  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Successfully joined group with generation Generation{generationId=1, memberId='consumer-testGroupId-1-d0b52c3a-39df-46d2-9625-df62b58371cd', protocol='range'}
2022-05-13 22:07:47.175  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Finished assignment for group at generation 1: {consumer-testGroupId-1-d0b52c3a-39df-46d2-9625-df62b58371cd=Assignment(partitions=[test-0])}
2022-05-13 22:07:47.182  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Successfully synced group in generation Generation{generationId=1, memberId='consumer-testGroupId-1-d0b52c3a-39df-46d2-9625-df62b58371cd', protocol='range'}
2022-05-13 22:07:47.182  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Notifying assignor about the new Assignment(partitions=[test-0])
2022-05-13 22:07:47.184  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Adding newly assigned partitions: test-0
2022-05-13 22:07:47.189  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Found no committed offset for partition test-0
2022-05-13 22:07:47.192  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Found no committed offset for partition test-0
2022-05-13 22:07:47.208  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.SubscriptionState    : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Resetting offset for partition test-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[DESKTOP-KDSIOVU:9092 (id: 0 rack: null)], epoch=0}}.
2022-05-13 22:07:47.213  INFO 12408 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : testGroupId: partitions assigned: [test-0]
2022-05-13 22:07:47.722  INFO 12408 --- [RMI TCP Connection(5)-169.254.74.73] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-05-13 22:07:47.722  INFO 12408 --- [RMI TCP Connection(5)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-05-13 22:07:47.723  INFO 12408 --- [RMI TCP Connection(5)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2022-05-13 22:09:10.178  INFO 6264 --- [main] ru.otus.homework03.Main                  : Starting Main using Java 14.0.1 on DESKTOP-KDSIOVU with PID 6264 (C:\projects\otus_homework\homework03\target\classes started by yanin in C:\projects\otus_homework\homework03)
2022-05-13 22:09:10.180  INFO 6264 --- [main] ru.otus.homework03.Main                  : No active profile set, falling back to 1 default profile: "default"
2022-05-13 22:09:11.102  INFO 6264 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-05-13 22:09:11.175  INFO 6264 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 65 ms. Found 5 JPA repository interfaces.
2022-05-13 22:09:11.605  INFO 6264 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-05-13 22:09:11.613  INFO 6264 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-05-13 22:09:11.613  INFO 6264 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-05-13 22:09:11.717  INFO 6264 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-05-13 22:09:11.717  INFO 6264 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1496 ms
2022-05-13 22:09:11.807  INFO 6264 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-05-13 22:09:11.900  INFO 6264 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-05-13 22:09:11.908  INFO 6264 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2022-05-13 22:09:12.122  INFO 6264 --- [main] liquibase.database                       : Set default schema name to PUBLIC
2022-05-13 22:09:12.251  INFO 6264 --- [main] liquibase.lockservice                    : Successfully acquired change log lock
2022-05-13 22:09:12.267  INFO 6264 --- [main] liquibase.changelog                      : Reading resource: db/changelog/1.0/2022-03-01--0001.xml
2022-05-13 22:09:12.675  INFO 6264 --- [main] liquibase.changelog                      : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2022-05-13 22:09:12.678  INFO 6264 --- [main] liquibase.changelog                      : Reading from PUBLIC.DATABASECHANGELOG
2022-05-13 22:09:12.750  INFO 6264 --- [main] liquibase.changelog                      : Table authors created
2022-05-13 22:09:12.751  INFO 6264 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-authorsTableCreate::ryanin ran successfully in 24ms
2022-05-13 22:09:12.771  INFO 6264 --- [main] liquibase.changelog                      : Table genres created
2022-05-13 22:09:12.772  INFO 6264 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-genresTableCreate::ryanin ran successfully in 7ms
2022-05-13 22:09:12.787  INFO 6264 --- [main] liquibase.changelog                      : Table books created
2022-05-13 22:09:12.787  INFO 6264 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-booksTableCreate::ryanin ran successfully in 14ms
2022-05-13 22:09:12.798  INFO 6264 --- [main] liquibase.changelog                      : Table commentaries created
2022-05-13 22:09:12.799  INFO 6264 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-commentariesTableCreate::ryanin ran successfully in 11ms
2022-05-13 22:09:12.808  INFO 6264 --- [main] liquibase.changelog                      : Table users created
2022-05-13 22:09:12.808  INFO 6264 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-usersTableCreate::ryanin ran successfully in 7ms
2022-05-13 22:09:12.818  INFO 6264 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:09:12.818  INFO 6264 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/authorsTableFill.csv' into table 'authors'
2022-05-13 22:09:12.818  INFO 6264 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/authorsTableFill.xml::authorsTableFill::ryanin ran successfully in 8ms
2022-05-13 22:09:12.823  INFO 6264 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:09:12.823  INFO 6264 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/genresTableFill.csv' into table 'genres'
2022-05-13 22:09:12.824  INFO 6264 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/genresTableFill.xml::genresTableFill::ryanin ran successfully in 4ms
2022-05-13 22:09:12.829  INFO 6264 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:09:12.830  INFO 6264 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/booksTableFill.csv' into table 'books'
2022-05-13 22:09:12.830  INFO 6264 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/booksTableFill.xml::booksTableFill::ryanin ran successfully in 5ms
2022-05-13 22:09:12.836  INFO 6264 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:09:12.836  INFO 6264 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/commentariesTableFill.csv' into table 'commentaries'
2022-05-13 22:09:12.837  INFO 6264 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/commentariesTableFill.xml::commentariesTableFill::ryanin ran successfully in 5ms
2022-05-13 22:09:12.842  INFO 6264 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:09:12.842  INFO 6264 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/usersTableFill.csv' into table 'users'
2022-05-13 22:09:12.842  INFO 6264 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/usersTableFill.xml::userTableFill::ryanin ran successfully in 4ms
2022-05-13 22:09:12.844  INFO 6264 --- [main] liquibase.lockservice                    : Successfully released change log lock
2022-05-13 22:09:12.930  INFO 6264 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-05-13 22:09:12.971  INFO 6264 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.5.Final
2022-05-13 22:09:13.092  INFO 6264 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-05-13 22:09:13.195  INFO 6264 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-05-13 22:09:13.625  INFO 6264 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-05-13 22:09:13.633  INFO 6264 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 22:09:13.961  WARN 6264 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-05-13 22:09:14.263  INFO 6264 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-05-13 22:09:14.707  INFO 6264 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path '/actuator'
2022-05-13 22:09:14.772  INFO 6264 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-05-13 22:09:14.815  INFO 6264 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:09:14.816  INFO 6264 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:09:14.816  INFO 6264 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652468954814
2022-05-13 22:09:15.082  INFO 6264 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-05-13 22:09:15.086  INFO 6264 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-05-13 22:09:15.086  INFO 6264 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-05-13 22:09:15.086  INFO 6264 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-05-13 22:09:15.103  INFO 6264 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-testGroupId-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = testGroupId
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2022-05-13 22:09:15.124  INFO 6264 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:09:15.124  INFO 6264 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:09:15.124  INFO 6264 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652468955124
2022-05-13 22:09:15.126  INFO 6264 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Subscribed to topic(s): test
2022-05-13 22:09:15.140  INFO 6264 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-05-13 22:09:15.144  INFO 6264 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 22:09:15.145  INFO 6264 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Discovered group coordinator DESKTOP-KDSIOVU:9092 (id: 2147483647 rack: null)
2022-05-13 22:09:15.147  INFO 6264 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:09:15.154  INFO 6264 --- [main] ru.otus.homework03.Main                  : Started Main in 5.342 seconds (JVM running for 5.875)
2022-05-13 22:09:15.159  INFO 6264 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Request joining group due to: need to re-join with the given member-id
2022-05-13 22:09:15.159  INFO 6264 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:09:15.162  INFO 6264 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Successfully joined group with generation Generation{generationId=3, memberId='consumer-testGroupId-1-e7663cf7-0120-45f6-b57c-cd5abd64dd8a', protocol='range'}
2022-05-13 22:09:15.164  INFO 6264 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Finished assignment for group at generation 3: {consumer-testGroupId-1-e7663cf7-0120-45f6-b57c-cd5abd64dd8a=Assignment(partitions=[test-0])}
2022-05-13 22:09:15.171  INFO 6264 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Successfully synced group in generation Generation{generationId=3, memberId='consumer-testGroupId-1-e7663cf7-0120-45f6-b57c-cd5abd64dd8a', protocol='range'}
2022-05-13 22:09:15.172  INFO 6264 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Notifying assignor about the new Assignment(partitions=[test-0])
2022-05-13 22:09:15.174  INFO 6264 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Adding newly assigned partitions: test-0
2022-05-13 22:09:15.184  INFO 6264 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Setting offset for partition test-0 to the committed offset FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[DESKTOP-KDSIOVU:9092 (id: 0 rack: null)], epoch=0}}
2022-05-13 22:09:15.185  INFO 6264 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : testGroupId: partitions assigned: [test-0]
2022-05-13 22:09:15.630  INFO 6264 --- [RMI TCP Connection(6)-169.254.74.73] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-05-13 22:09:15.631  INFO 6264 --- [RMI TCP Connection(6)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-05-13 22:09:15.633  INFO 6264 --- [RMI TCP Connection(6)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2022-05-13 22:09:25.846 ERROR 6264 --- [http-nio-8080-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception

org.springframework.security.web.firewall.RequestRejectedException: The request was rejected because the URL contained a potentially malicious String "//"
	at org.springframework.security.web.firewall.StrictHttpFirewall.rejectedBlocklistedUrls(StrictHttpFirewall.java:456) ~[spring-security-web-5.6.2.jar:5.6.2]
	at org.springframework.security.web.firewall.StrictHttpFirewall.getFirewalledRequest(StrictHttpFirewall.java:429) ~[spring-security-web-5.6.2.jar:5.6.2]
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:196) ~[spring-security-web-5.6.2.jar:5.6.2]
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:183) ~[spring-security-web-5.6.2.jar:5.6.2]
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354) ~[spring-web-5.3.16.jar:5.3.16]
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267) ~[spring-web-5.3.16.jar:5.3.16]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.3.16.jar:5.3.16]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.16.jar:5.3.16]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.3.16.jar:5.3.16]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.16.jar:5.3.16]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96) ~[spring-boot-actuator-2.6.4.jar:2.6.4]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.16.jar:5.3.16]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.3.16.jar:5.3.16]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117) ~[spring-web-5.3.16.jar:5.3.16]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:540) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:359) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:889) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1735) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.58.jar:9.0.58]
	at java.base/java.lang.Thread.run(Thread.java:832) ~[na:na]

2022-05-13 22:09:32.879  INFO 6264 --- [http-nio-8080-exec-3] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2022-05-13 22:09:32.893  INFO 6264 --- [http-nio-8080-exec-3] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:09:32.893  INFO 6264 --- [http-nio-8080-exec-3] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:09:32.893  INFO 6264 --- [http-nio-8080-exec-3] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652468972892
2022-05-13 22:09:32.898  INFO 6264 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 22:10:33.201  INFO 20136 --- [main] ru.otus.homework03.Main                  : Starting Main using Java 14.0.1 on DESKTOP-KDSIOVU with PID 20136 (C:\projects\otus_homework\homework03\target\classes started by yanin in C:\projects\otus_homework\homework03)
2022-05-13 22:10:33.204  INFO 20136 --- [main] ru.otus.homework03.Main                  : No active profile set, falling back to 1 default profile: "default"
2022-05-13 22:10:34.049  INFO 20136 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-05-13 22:10:34.119  INFO 20136 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 62 ms. Found 5 JPA repository interfaces.
2022-05-13 22:10:34.572  INFO 20136 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-05-13 22:10:34.579  INFO 20136 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-05-13 22:10:34.580  INFO 20136 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-05-13 22:10:34.694  INFO 20136 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-05-13 22:10:34.695  INFO 20136 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1445 ms
2022-05-13 22:10:34.781  INFO 20136 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-05-13 22:10:34.881  INFO 20136 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-05-13 22:10:34.896  INFO 20136 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2022-05-13 22:10:35.174  INFO 20136 --- [main] liquibase.database                       : Set default schema name to PUBLIC
2022-05-13 22:10:35.301  INFO 20136 --- [main] liquibase.lockservice                    : Successfully acquired change log lock
2022-05-13 22:10:35.318  INFO 20136 --- [main] liquibase.changelog                      : Reading resource: db/changelog/1.0/2022-03-01--0001.xml
2022-05-13 22:10:35.653  INFO 20136 --- [main] liquibase.changelog                      : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2022-05-13 22:10:35.656  INFO 20136 --- [main] liquibase.changelog                      : Reading from PUBLIC.DATABASECHANGELOG
2022-05-13 22:10:35.726  INFO 20136 --- [main] liquibase.changelog                      : Table authors created
2022-05-13 22:10:35.726  INFO 20136 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-authorsTableCreate::ryanin ran successfully in 22ms
2022-05-13 22:10:35.741  INFO 20136 --- [main] liquibase.changelog                      : Table genres created
2022-05-13 22:10:35.741  INFO 20136 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-genresTableCreate::ryanin ran successfully in 6ms
2022-05-13 22:10:35.756  INFO 20136 --- [main] liquibase.changelog                      : Table books created
2022-05-13 22:10:35.756  INFO 20136 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-booksTableCreate::ryanin ran successfully in 14ms
2022-05-13 22:10:35.766  INFO 20136 --- [main] liquibase.changelog                      : Table commentaries created
2022-05-13 22:10:35.766  INFO 20136 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-commentariesTableCreate::ryanin ran successfully in 9ms
2022-05-13 22:10:35.787  INFO 20136 --- [main] liquibase.changelog                      : Table users created
2022-05-13 22:10:35.788  INFO 20136 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-usersTableCreate::ryanin ran successfully in 20ms
2022-05-13 22:10:35.796  INFO 20136 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:10:35.797  INFO 20136 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/authorsTableFill.csv' into table 'authors'
2022-05-13 22:10:35.797  INFO 20136 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/authorsTableFill.xml::authorsTableFill::ryanin ran successfully in 8ms
2022-05-13 22:10:35.801  INFO 20136 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:10:35.802  INFO 20136 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/genresTableFill.csv' into table 'genres'
2022-05-13 22:10:35.802  INFO 20136 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/genresTableFill.xml::genresTableFill::ryanin ran successfully in 4ms
2022-05-13 22:10:35.807  INFO 20136 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:10:35.807  INFO 20136 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/booksTableFill.csv' into table 'books'
2022-05-13 22:10:35.807  INFO 20136 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/booksTableFill.xml::booksTableFill::ryanin ran successfully in 4ms
2022-05-13 22:10:35.812  INFO 20136 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:10:35.813  INFO 20136 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/commentariesTableFill.csv' into table 'commentaries'
2022-05-13 22:10:35.813  INFO 20136 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/commentariesTableFill.xml::commentariesTableFill::ryanin ran successfully in 4ms
2022-05-13 22:10:35.818  INFO 20136 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:10:35.818  INFO 20136 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/usersTableFill.csv' into table 'users'
2022-05-13 22:10:35.819  INFO 20136 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/usersTableFill.xml::userTableFill::ryanin ran successfully in 4ms
2022-05-13 22:10:35.820  INFO 20136 --- [main] liquibase.lockservice                    : Successfully released change log lock
2022-05-13 22:10:35.897  INFO 20136 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-05-13 22:10:35.936  INFO 20136 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.5.Final
2022-05-13 22:10:36.054  INFO 20136 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-05-13 22:10:36.179  INFO 20136 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-05-13 22:10:36.660  INFO 20136 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-05-13 22:10:36.668  INFO 20136 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 22:10:36.971  WARN 20136 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-05-13 22:10:37.269  INFO 20136 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-05-13 22:10:37.815  INFO 20136 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path '/actuator'
2022-05-13 22:10:37.885  INFO 20136 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-05-13 22:10:37.925  INFO 20136 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:10:37.925  INFO 20136 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:10:37.925  INFO 20136 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469037924
2022-05-13 22:10:38.191  INFO 20136 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-05-13 22:10:38.195  INFO 20136 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-05-13 22:10:38.195  INFO 20136 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-05-13 22:10:38.195  INFO 20136 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-05-13 22:10:38.212  INFO 20136 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-testGroupId-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = testGroupId
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2022-05-13 22:10:38.237  INFO 20136 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:10:38.237  INFO 20136 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:10:38.237  INFO 20136 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469038237
2022-05-13 22:10:38.239  INFO 20136 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Subscribed to topic(s): test
2022-05-13 22:10:38.255  INFO 20136 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-05-13 22:10:38.259  INFO 20136 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 22:10:38.260  INFO 20136 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Discovered group coordinator DESKTOP-KDSIOVU:9092 (id: 2147483647 rack: null)
2022-05-13 22:10:38.262  INFO 20136 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:10:38.270  INFO 20136 --- [main] ru.otus.homework03.Main                  : Started Main in 5.451 seconds (JVM running for 5.994)
2022-05-13 22:10:38.275  INFO 20136 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Request joining group due to: need to re-join with the given member-id
2022-05-13 22:10:38.276  INFO 20136 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:10:38.693  INFO 20136 --- [RMI TCP Connection(3)-169.254.74.73] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-05-13 22:10:38.693  INFO 20136 --- [RMI TCP Connection(3)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-05-13 22:10:38.694  INFO 20136 --- [RMI TCP Connection(3)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2022-05-13 22:10:42.757  INFO 20136 --- [http-nio-8080-exec-2] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2022-05-13 22:10:42.771  INFO 20136 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:10:42.771  INFO 20136 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:10:42.771  INFO 20136 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469042771
2022-05-13 22:10:42.775  INFO 20136 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 22:11:44.336  INFO 3876 --- [main] ru.otus.homework03.Main                  : Starting Main using Java 14.0.1 on DESKTOP-KDSIOVU with PID 3876 (C:\projects\otus_homework\homework03\target\classes started by yanin in C:\projects\otus_homework\homework03)
2022-05-13 22:11:44.338  INFO 3876 --- [main] ru.otus.homework03.Main                  : No active profile set, falling back to 1 default profile: "default"
2022-05-13 22:11:45.254  INFO 3876 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-05-13 22:11:45.329  INFO 3876 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 66 ms. Found 5 JPA repository interfaces.
2022-05-13 22:11:45.766  INFO 3876 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-05-13 22:11:45.774  INFO 3876 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-05-13 22:11:45.774  INFO 3876 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-05-13 22:11:45.882  INFO 3876 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-05-13 22:11:45.882  INFO 3876 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1498 ms
2022-05-13 22:11:45.969  INFO 3876 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-05-13 22:11:46.038  INFO 3876 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-05-13 22:11:46.051  INFO 3876 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2022-05-13 22:11:46.254  INFO 3876 --- [main] liquibase.database                       : Set default schema name to PUBLIC
2022-05-13 22:11:46.382  INFO 3876 --- [main] liquibase.lockservice                    : Successfully acquired change log lock
2022-05-13 22:11:46.397  INFO 3876 --- [main] liquibase.changelog                      : Reading resource: db/changelog/1.0/2022-03-01--0001.xml
2022-05-13 22:11:46.756  INFO 3876 --- [main] liquibase.changelog                      : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2022-05-13 22:11:46.759  INFO 3876 --- [main] liquibase.changelog                      : Reading from PUBLIC.DATABASECHANGELOG
2022-05-13 22:11:46.832  INFO 3876 --- [main] liquibase.changelog                      : Table authors created
2022-05-13 22:11:46.833  INFO 3876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-authorsTableCreate::ryanin ran successfully in 22ms
2022-05-13 22:11:46.848  INFO 3876 --- [main] liquibase.changelog                      : Table genres created
2022-05-13 22:11:46.848  INFO 3876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-genresTableCreate::ryanin ran successfully in 7ms
2022-05-13 22:11:46.862  INFO 3876 --- [main] liquibase.changelog                      : Table books created
2022-05-13 22:11:46.863  INFO 3876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-booksTableCreate::ryanin ran successfully in 14ms
2022-05-13 22:11:46.873  INFO 3876 --- [main] liquibase.changelog                      : Table commentaries created
2022-05-13 22:11:46.873  INFO 3876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-commentariesTableCreate::ryanin ran successfully in 8ms
2022-05-13 22:11:46.882  INFO 3876 --- [main] liquibase.changelog                      : Table users created
2022-05-13 22:11:46.882  INFO 3876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-usersTableCreate::ryanin ran successfully in 7ms
2022-05-13 22:11:46.891  INFO 3876 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:11:46.891  INFO 3876 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/authorsTableFill.csv' into table 'authors'
2022-05-13 22:11:46.891  INFO 3876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/authorsTableFill.xml::authorsTableFill::ryanin ran successfully in 8ms
2022-05-13 22:11:46.896  INFO 3876 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:11:46.896  INFO 3876 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/genresTableFill.csv' into table 'genres'
2022-05-13 22:11:46.896  INFO 3876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/genresTableFill.xml::genresTableFill::ryanin ran successfully in 3ms
2022-05-13 22:11:46.902  INFO 3876 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:11:46.902  INFO 3876 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/booksTableFill.csv' into table 'books'
2022-05-13 22:11:46.902  INFO 3876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/booksTableFill.xml::booksTableFill::ryanin ran successfully in 4ms
2022-05-13 22:11:46.907  INFO 3876 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:11:46.907  INFO 3876 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/commentariesTableFill.csv' into table 'commentaries'
2022-05-13 22:11:46.908  INFO 3876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/commentariesTableFill.xml::commentariesTableFill::ryanin ran successfully in 4ms
2022-05-13 22:11:46.912  INFO 3876 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:11:46.913  INFO 3876 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/usersTableFill.csv' into table 'users'
2022-05-13 22:11:46.913  INFO 3876 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/usersTableFill.xml::userTableFill::ryanin ran successfully in 4ms
2022-05-13 22:11:46.915  INFO 3876 --- [main] liquibase.lockservice                    : Successfully released change log lock
2022-05-13 22:11:46.993  INFO 3876 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-05-13 22:11:47.041  INFO 3876 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.5.Final
2022-05-13 22:11:47.157  INFO 3876 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-05-13 22:11:47.261  INFO 3876 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-05-13 22:11:47.694  INFO 3876 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-05-13 22:11:47.702  INFO 3876 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 22:11:48.000  WARN 3876 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-05-13 22:11:48.276  INFO 3876 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-05-13 22:11:48.749  INFO 3876 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path '/actuator'
2022-05-13 22:11:48.817  INFO 3876 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-05-13 22:11:48.860  INFO 3876 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:11:48.861  INFO 3876 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:11:48.861  INFO 3876 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469108859
2022-05-13 22:11:49.116  INFO 3876 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-05-13 22:11:49.121  INFO 3876 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-05-13 22:11:49.121  INFO 3876 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-05-13 22:11:49.121  INFO 3876 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-05-13 22:11:49.139  INFO 3876 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-testGroupId-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = testGroupId
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2022-05-13 22:11:49.165  INFO 3876 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:11:49.165  INFO 3876 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:11:49.165  INFO 3876 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469109165
2022-05-13 22:11:49.166  INFO 3876 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Subscribed to topic(s): test
2022-05-13 22:11:49.184  INFO 3876 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-05-13 22:11:49.187  INFO 3876 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 22:11:49.188  INFO 3876 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Discovered group coordinator DESKTOP-KDSIOVU:9092 (id: 2147483647 rack: null)
2022-05-13 22:11:49.190  INFO 3876 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:11:49.197  INFO 3876 --- [main] ru.otus.homework03.Main                  : Started Main in 5.248 seconds (JVM running for 5.794)
2022-05-13 22:11:49.203  INFO 3876 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Request joining group due to: need to re-join with the given member-id
2022-05-13 22:11:49.203  INFO 3876 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:11:49.748  INFO 3876 --- [RMI TCP Connection(5)-169.254.74.73] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-05-13 22:11:49.748  INFO 3876 --- [RMI TCP Connection(5)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-05-13 22:11:49.750  INFO 3876 --- [RMI TCP Connection(5)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2022-05-13 22:11:57.386  INFO 3876 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Successfully joined group with generation Generation{generationId=5, memberId='consumer-testGroupId-1-6233c575-96b8-4740-8146-44f0f4039471', protocol='range'}
2022-05-13 22:11:57.391  INFO 3876 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Finished assignment for group at generation 5: {consumer-testGroupId-1-6233c575-96b8-4740-8146-44f0f4039471=Assignment(partitions=[test-0])}
2022-05-13 22:11:57.407  INFO 3876 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Successfully synced group in generation Generation{generationId=5, memberId='consumer-testGroupId-1-6233c575-96b8-4740-8146-44f0f4039471', protocol='range'}
2022-05-13 22:11:57.408  INFO 3876 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Notifying assignor about the new Assignment(partitions=[test-0])
2022-05-13 22:11:57.412  INFO 3876 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Adding newly assigned partitions: test-0
2022-05-13 22:11:57.427  INFO 3876 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Setting offset for partition test-0 to the committed offset FetchPosition{offset=1, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[DESKTOP-KDSIOVU:9092 (id: 0 rack: null)], epoch=0}}
2022-05-13 22:11:57.428  INFO 3876 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : testGroupId: partitions assigned: [test-0]
2022-05-13 22:11:59.153  INFO 3876 --- [http-nio-8080-exec-2] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2022-05-13 22:11:59.165  INFO 3876 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:11:59.166  INFO 3876 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:11:59.166  INFO 3876 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469119165
2022-05-13 22:11:59.169  INFO 3876 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 22:13:39.346  INFO 12676 --- [main] ru.otus.homework03.Main                  : Starting Main using Java 14.0.1 on DESKTOP-KDSIOVU with PID 12676 (C:\projects\otus_homework\homework03\target\classes started by yanin in C:\projects\otus_homework\homework03)
2022-05-13 22:13:39.351  INFO 12676 --- [main] ru.otus.homework03.Main                  : No active profile set, falling back to 1 default profile: "default"
2022-05-13 22:13:40.284  INFO 12676 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-05-13 22:13:40.362  INFO 12676 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 70 ms. Found 5 JPA repository interfaces.
2022-05-13 22:13:40.811  INFO 12676 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-05-13 22:13:40.819  INFO 12676 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-05-13 22:13:40.820  INFO 12676 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-05-13 22:13:40.963  INFO 12676 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-05-13 22:13:40.963  INFO 12676 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1559 ms
2022-05-13 22:13:41.058  INFO 12676 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-05-13 22:13:41.126  INFO 12676 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-05-13 22:13:41.133  INFO 12676 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2022-05-13 22:13:41.330  INFO 12676 --- [main] liquibase.database                       : Set default schema name to PUBLIC
2022-05-13 22:13:41.456  INFO 12676 --- [main] liquibase.lockservice                    : Successfully acquired change log lock
2022-05-13 22:13:41.473  INFO 12676 --- [main] liquibase.changelog                      : Reading resource: db/changelog/1.0/2022-03-01--0001.xml
2022-05-13 22:13:41.836  INFO 12676 --- [main] liquibase.changelog                      : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2022-05-13 22:13:41.838  INFO 12676 --- [main] liquibase.changelog                      : Reading from PUBLIC.DATABASECHANGELOG
2022-05-13 22:13:41.908  INFO 12676 --- [main] liquibase.changelog                      : Table authors created
2022-05-13 22:13:41.909  INFO 12676 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-authorsTableCreate::ryanin ran successfully in 21ms
2022-05-13 22:13:41.923  INFO 12676 --- [main] liquibase.changelog                      : Table genres created
2022-05-13 22:13:41.924  INFO 12676 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-genresTableCreate::ryanin ran successfully in 6ms
2022-05-13 22:13:41.938  INFO 12676 --- [main] liquibase.changelog                      : Table books created
2022-05-13 22:13:41.938  INFO 12676 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-booksTableCreate::ryanin ran successfully in 13ms
2022-05-13 22:13:41.947  INFO 12676 --- [main] liquibase.changelog                      : Table commentaries created
2022-05-13 22:13:41.947  INFO 12676 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-commentariesTableCreate::ryanin ran successfully in 7ms
2022-05-13 22:13:41.956  INFO 12676 --- [main] liquibase.changelog                      : Table users created
2022-05-13 22:13:41.957  INFO 12676 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-usersTableCreate::ryanin ran successfully in 7ms
2022-05-13 22:13:41.965  INFO 12676 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:13:41.966  INFO 12676 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/authorsTableFill.csv' into table 'authors'
2022-05-13 22:13:41.966  INFO 12676 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/authorsTableFill.xml::authorsTableFill::ryanin ran successfully in 8ms
2022-05-13 22:13:41.972  INFO 12676 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:13:41.972  INFO 12676 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/genresTableFill.csv' into table 'genres'
2022-05-13 22:13:41.973  INFO 12676 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/genresTableFill.xml::genresTableFill::ryanin ran successfully in 4ms
2022-05-13 22:13:41.978  INFO 12676 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:13:41.978  INFO 12676 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/booksTableFill.csv' into table 'books'
2022-05-13 22:13:41.978  INFO 12676 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/booksTableFill.xml::booksTableFill::ryanin ran successfully in 4ms
2022-05-13 22:13:41.984  INFO 12676 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:13:41.984  INFO 12676 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/commentariesTableFill.csv' into table 'commentaries'
2022-05-13 22:13:41.985  INFO 12676 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/commentariesTableFill.xml::commentariesTableFill::ryanin ran successfully in 6ms
2022-05-13 22:13:41.990  INFO 12676 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:13:41.990  INFO 12676 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/usersTableFill.csv' into table 'users'
2022-05-13 22:13:41.990  INFO 12676 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/usersTableFill.xml::userTableFill::ryanin ran successfully in 4ms
2022-05-13 22:13:41.993  INFO 12676 --- [main] liquibase.lockservice                    : Successfully released change log lock
2022-05-13 22:13:42.082  INFO 12676 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-05-13 22:13:42.120  INFO 12676 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.5.Final
2022-05-13 22:13:42.218  INFO 12676 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-05-13 22:13:42.320  INFO 12676 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-05-13 22:13:42.761  INFO 12676 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-05-13 22:13:42.769  INFO 12676 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 22:13:43.082  WARN 12676 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-05-13 22:13:43.363  INFO 12676 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-05-13 22:13:43.872  INFO 12676 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path '/actuator'
2022-05-13 22:13:43.935  INFO 12676 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-05-13 22:13:43.977  INFO 12676 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:13:43.977  INFO 12676 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:13:43.978  INFO 12676 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469223976
2022-05-13 22:13:44.252  INFO 12676 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-05-13 22:13:44.256  INFO 12676 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-05-13 22:13:44.257  INFO 12676 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-05-13 22:13:44.257  INFO 12676 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-05-13 22:13:44.274  INFO 12676 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-testGroupId-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = testGroupId
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2022-05-13 22:13:44.297  INFO 12676 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:13:44.297  INFO 12676 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:13:44.297  INFO 12676 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469224297
2022-05-13 22:13:44.298  INFO 12676 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Subscribed to topic(s): test
2022-05-13 22:13:44.316  INFO 12676 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-05-13 22:13:44.323  INFO 12676 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 22:13:44.324  INFO 12676 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Discovered group coordinator DESKTOP-KDSIOVU:9092 (id: 2147483647 rack: null)
2022-05-13 22:13:44.325  INFO 12676 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:13:44.331  INFO 12676 --- [main] ru.otus.homework03.Main                  : Started Main in 5.381 seconds (JVM running for 6.041)
2022-05-13 22:13:44.338  INFO 12676 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Request joining group due to: need to re-join with the given member-id
2022-05-13 22:13:44.338  INFO 12676 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:13:44.634  INFO 12676 --- [RMI TCP Connection(7)-169.254.74.73] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-05-13 22:13:44.634  INFO 12676 --- [RMI TCP Connection(7)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-05-13 22:13:44.635  INFO 12676 --- [RMI TCP Connection(7)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2022-05-13 22:13:47.718  INFO 12676 --- [http-nio-8080-exec-2] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2022-05-13 22:13:47.733  INFO 12676 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:13:47.734  INFO 12676 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:13:47.734  INFO 12676 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469227733
2022-05-13 22:13:47.740  INFO 12676 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 22:14:06.587  INFO 12676 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Successfully joined group with generation Generation{generationId=6, memberId='consumer-testGroupId-1-dec5afcf-ea3f-451a-8ddd-6890201a4f6c', protocol='range'}
2022-05-13 22:14:06.589  INFO 12676 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Finished assignment for group at generation 6: {consumer-testGroupId-1-dec5afcf-ea3f-451a-8ddd-6890201a4f6c=Assignment(partitions=[test-0])}
2022-05-13 22:14:06.595  INFO 12676 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Successfully synced group in generation Generation{generationId=6, memberId='consumer-testGroupId-1-dec5afcf-ea3f-451a-8ddd-6890201a4f6c', protocol='range'}
2022-05-13 22:14:06.596  INFO 12676 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Notifying assignor about the new Assignment(partitions=[test-0])
2022-05-13 22:14:06.598  INFO 12676 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Adding newly assigned partitions: test-0
2022-05-13 22:14:06.610  INFO 12676 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Setting offset for partition test-0 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[DESKTOP-KDSIOVU:9092 (id: 0 rack: null)], epoch=0}}
2022-05-13 22:14:06.611  INFO 12676 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : testGroupId: partitions assigned: [test-0]
2022-05-13 22:14:06.634 ERROR 12676 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.kafka.listener.DefaultErrorHandler   : Backoff none exhausted for test-0@3

org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method could not be invoked with the incoming message
Endpoint handler details:
Method [void ru.otus.homework03.listener.KafkaListeners.listener(java.lang.String)]
Bean [ru.otus.homework03.listener.KafkaListeners@3fc2a1d1]; nested exception is org.springframework.messaging.handler.annotation.support.MethodArgumentNotValidException: Could not resolve method parameter at index 0 in void ru.otus.homework03.listener.KafkaListeners.listener(java.lang.String): 1 error(s): [Error in object 'data': codes []; arguments []; default message [Payload value must not be empty]] , failedMessage=GenericMessage [payload=org.springframework.kafka.support.KafkaNull@13d7d871, headers={kafka_offset=3, kafka_consumer=org.apache.kafka.clients.consumer.KafkaConsumer@281c4f30, kafka_timestampType=CREATE_TIME, kafka_receivedPartitionId=0, kafka_receivedTopic=test, kafka_receivedTimestamp=1652469227744, kafka_groupId=testGroupId}]; nested exception is org.springframework.messaging.handler.annotation.support.MethodArgumentNotValidException: Could not resolve method parameter at index 0 in void ru.otus.homework03.listener.KafkaListeners.listener(java.lang.String): 1 error(s): [Error in object 'data': codes []; arguments []; default message [Payload value must not be empty]] , failedMessage=GenericMessage [payload=org.springframework.kafka.support.KafkaNull@13d7d871, headers={kafka_offset=3, kafka_consumer=org.apache.kafka.clients.consumer.KafkaConsumer@281c4f30, kafka_timestampType=CREATE_TIME, kafka_receivedPartitionId=0, kafka_receivedTopic=test, kafka_receivedTimestamp=1652469227744, kafka_groupId=testGroupId}]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2687) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2657) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2617) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2544) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2429) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2307) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1981) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1365) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1356) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1251) ~[spring-kafka-2.8.5.jar:2.8.5]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:832) ~[na:na]
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.checkAckArg(MessagingMessageListenerAdapter.java:374) ~[spring-kafka-2.8.5.jar:2.8.5]
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:355) ~[spring-kafka-2.8.5.jar:2.8.5]
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.5.jar:2.8.5]
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.5.jar:2.8.5]
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2637) ~[spring-kafka-2.8.5.jar:2.8.5]
Caused by: org.springframework.messaging.handler.annotation.support.MethodArgumentNotValidException: Could not resolve method parameter at index 0 in void ru.otus.homework03.listener.KafkaListeners.listener(java.lang.String): 1 error(s): [Error in object 'data': codes []; arguments []; default message [Payload value must not be empty]] 
	at org.springframework.messaging.handler.annotation.support.PayloadMethodArgumentResolver.resolveArgument(PayloadMethodArgumentResolver.java:122) ~[spring-messaging-5.3.16.jar:5.3.16]
	at org.springframework.kafka.annotation.KafkaNullAwarePayloadArgumentResolver.resolveArgument(KafkaNullAwarePayloadArgumentResolver.java:46) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.messaging.handler.invocation.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:118) ~[spring-messaging-5.3.16.jar:5.3.16]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:147) ~[spring-messaging-5.3.16.jar:5.3.16]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:115) ~[spring-messaging-5.3.16.jar:5.3.16]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2637) ~[spring-kafka-2.8.5.jar:2.8.5]
	... 11 common frames omitted

2022-05-13 22:15:50.461  INFO 13660 --- [main] ru.otus.homework03.Main                  : Starting Main using Java 14.0.1 on DESKTOP-KDSIOVU with PID 13660 (C:\projects\otus_homework\homework03\target\classes started by yanin in C:\projects\otus_homework\homework03)
2022-05-13 22:15:50.464  INFO 13660 --- [main] ru.otus.homework03.Main                  : No active profile set, falling back to 1 default profile: "default"
2022-05-13 22:15:51.340  INFO 13660 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-05-13 22:15:51.408  INFO 13660 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 60 ms. Found 5 JPA repository interfaces.
2022-05-13 22:15:51.847  INFO 13660 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-05-13 22:15:51.854  INFO 13660 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-05-13 22:15:51.855  INFO 13660 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-05-13 22:15:51.960  INFO 13660 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-05-13 22:15:51.960  INFO 13660 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1454 ms
2022-05-13 22:15:52.041  INFO 13660 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-05-13 22:15:52.114  INFO 13660 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-05-13 22:15:52.121  INFO 13660 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2022-05-13 22:15:52.290  INFO 13660 --- [main] liquibase.database                       : Set default schema name to PUBLIC
2022-05-13 22:15:52.418  INFO 13660 --- [main] liquibase.lockservice                    : Successfully acquired change log lock
2022-05-13 22:15:52.434  INFO 13660 --- [main] liquibase.changelog                      : Reading resource: db/changelog/1.0/2022-03-01--0001.xml
2022-05-13 22:15:52.795  INFO 13660 --- [main] liquibase.changelog                      : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2022-05-13 22:15:52.798  INFO 13660 --- [main] liquibase.changelog                      : Reading from PUBLIC.DATABASECHANGELOG
2022-05-13 22:15:52.869  INFO 13660 --- [main] liquibase.changelog                      : Table authors created
2022-05-13 22:15:52.869  INFO 13660 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-authorsTableCreate::ryanin ran successfully in 21ms
2022-05-13 22:15:52.885  INFO 13660 --- [main] liquibase.changelog                      : Table genres created
2022-05-13 22:15:52.886  INFO 13660 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-genresTableCreate::ryanin ran successfully in 8ms
2022-05-13 22:15:52.901  INFO 13660 --- [main] liquibase.changelog                      : Table books created
2022-05-13 22:15:52.901  INFO 13660 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-booksTableCreate::ryanin ran successfully in 14ms
2022-05-13 22:15:52.911  INFO 13660 --- [main] liquibase.changelog                      : Table commentaries created
2022-05-13 22:15:52.912  INFO 13660 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-commentariesTableCreate::ryanin ran successfully in 10ms
2022-05-13 22:15:52.920  INFO 13660 --- [main] liquibase.changelog                      : Table users created
2022-05-13 22:15:52.921  INFO 13660 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-usersTableCreate::ryanin ran successfully in 8ms
2022-05-13 22:15:52.930  INFO 13660 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:15:52.931  INFO 13660 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/authorsTableFill.csv' into table 'authors'
2022-05-13 22:15:52.931  INFO 13660 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/authorsTableFill.xml::authorsTableFill::ryanin ran successfully in 9ms
2022-05-13 22:15:52.940  INFO 13660 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:15:52.940  INFO 13660 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/genresTableFill.csv' into table 'genres'
2022-05-13 22:15:52.941  INFO 13660 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/genresTableFill.xml::genresTableFill::ryanin ran successfully in 5ms
2022-05-13 22:15:52.948  INFO 13660 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:15:52.948  INFO 13660 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/booksTableFill.csv' into table 'books'
2022-05-13 22:15:52.949  INFO 13660 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/booksTableFill.xml::booksTableFill::ryanin ran successfully in 5ms
2022-05-13 22:15:52.954  INFO 13660 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:15:52.954  INFO 13660 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/commentariesTableFill.csv' into table 'commentaries'
2022-05-13 22:15:52.954  INFO 13660 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/commentariesTableFill.xml::commentariesTableFill::ryanin ran successfully in 4ms
2022-05-13 22:15:52.962  INFO 13660 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:15:52.962  INFO 13660 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/usersTableFill.csv' into table 'users'
2022-05-13 22:15:52.962  INFO 13660 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/usersTableFill.xml::userTableFill::ryanin ran successfully in 6ms
2022-05-13 22:15:52.964  INFO 13660 --- [main] liquibase.lockservice                    : Successfully released change log lock
2022-05-13 22:15:53.046  INFO 13660 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-05-13 22:15:53.084  INFO 13660 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.5.Final
2022-05-13 22:15:53.203  INFO 13660 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-05-13 22:15:53.289  INFO 13660 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-05-13 22:15:53.690  INFO 13660 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-05-13 22:15:53.697  INFO 13660 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 22:15:54.017  WARN 13660 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-05-13 22:15:54.297  INFO 13660 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-05-13 22:15:54.773  INFO 13660 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path '/actuator'
2022-05-13 22:15:54.834  INFO 13660 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-05-13 22:15:54.875  INFO 13660 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:15:54.875  INFO 13660 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:15:54.875  INFO 13660 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469354873
2022-05-13 22:15:55.129  INFO 13660 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-05-13 22:15:55.133  INFO 13660 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-05-13 22:15:55.133  INFO 13660 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-05-13 22:15:55.133  INFO 13660 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-05-13 22:15:55.150  INFO 13660 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-testGroupId-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = testGroupId
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2022-05-13 22:15:55.173  INFO 13660 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:15:55.173  INFO 13660 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:15:55.173  INFO 13660 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469355173
2022-05-13 22:15:55.175  INFO 13660 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Subscribed to topic(s): test
2022-05-13 22:15:55.190  INFO 13660 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-05-13 22:15:55.194  INFO 13660 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 22:15:55.195  INFO 13660 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Discovered group coordinator DESKTOP-KDSIOVU:9092 (id: 2147483647 rack: null)
2022-05-13 22:15:55.196  INFO 13660 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:15:55.203  INFO 13660 --- [main] ru.otus.homework03.Main                  : Started Main in 5.123 seconds (JVM running for 5.692)
2022-05-13 22:15:55.209  INFO 13660 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Request joining group due to: need to re-join with the given member-id
2022-05-13 22:15:55.210  INFO 13660 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:15:55.212  INFO 13660 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Successfully joined group with generation Generation{generationId=8, memberId='consumer-testGroupId-1-fd98f624-339c-455e-90d1-802998ae07f0', protocol='range'}
2022-05-13 22:15:55.214  INFO 13660 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Finished assignment for group at generation 8: {consumer-testGroupId-1-fd98f624-339c-455e-90d1-802998ae07f0=Assignment(partitions=[test-0])}
2022-05-13 22:15:55.221  INFO 13660 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Successfully synced group in generation Generation{generationId=8, memberId='consumer-testGroupId-1-fd98f624-339c-455e-90d1-802998ae07f0', protocol='range'}
2022-05-13 22:15:55.222  INFO 13660 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Notifying assignor about the new Assignment(partitions=[test-0])
2022-05-13 22:15:55.224  INFO 13660 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Adding newly assigned partitions: test-0
2022-05-13 22:15:55.234  INFO 13660 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Setting offset for partition test-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[DESKTOP-KDSIOVU:9092 (id: 0 rack: null)], epoch=0}}
2022-05-13 22:15:55.235  INFO 13660 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : testGroupId: partitions assigned: [test-0]
2022-05-13 22:15:55.291  INFO 13660 --- [RMI TCP Connection(4)-169.254.74.73] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-05-13 22:15:55.291  INFO 13660 --- [RMI TCP Connection(4)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-05-13 22:15:55.293  INFO 13660 --- [RMI TCP Connection(4)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2022-05-13 22:16:16.829  INFO 13660 --- [http-nio-8080-exec-2] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2022-05-13 22:16:16.844  INFO 13660 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:16:16.844  INFO 13660 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:16:16.844  INFO 13660 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469376844
2022-05-13 22:16:16.848  INFO 13660 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 22:16:16.885 ERROR 13660 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.kafka.listener.DefaultErrorHandler   : Backoff none exhausted for test-0@4

org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method could not be invoked with the incoming message
Endpoint handler details:
Method [void ru.otus.homework03.listener.KafkaListeners.listener(java.lang.String)]
Bean [ru.otus.homework03.listener.KafkaListeners@71db6703]; nested exception is org.springframework.messaging.handler.annotation.support.MethodArgumentNotValidException: Could not resolve method parameter at index 0 in void ru.otus.homework03.listener.KafkaListeners.listener(java.lang.String): 1 error(s): [Error in object 'data': codes []; arguments []; default message [Payload value must not be empty]] , failedMessage=GenericMessage [payload=org.springframework.kafka.support.KafkaNull@34505ede, headers={kafka_offset=4, kafka_consumer=org.apache.kafka.clients.consumer.KafkaConsumer@4ab014f2, kafka_timestampType=CREATE_TIME, kafka_receivedPartitionId=0, kafka_receivedTopic=test, kafka_receivedTimestamp=1652469376852, kafka_groupId=testGroupId}]; nested exception is org.springframework.messaging.handler.annotation.support.MethodArgumentNotValidException: Could not resolve method parameter at index 0 in void ru.otus.homework03.listener.KafkaListeners.listener(java.lang.String): 1 error(s): [Error in object 'data': codes []; arguments []; default message [Payload value must not be empty]] , failedMessage=GenericMessage [payload=org.springframework.kafka.support.KafkaNull@34505ede, headers={kafka_offset=4, kafka_consumer=org.apache.kafka.clients.consumer.KafkaConsumer@4ab014f2, kafka_timestampType=CREATE_TIME, kafka_receivedPartitionId=0, kafka_receivedTopic=test, kafka_receivedTimestamp=1652469376852, kafka_groupId=testGroupId}]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2687) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2657) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2617) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2544) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2429) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2307) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1981) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1365) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1356) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1251) ~[spring-kafka-2.8.5.jar:2.8.5]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:832) ~[na:na]
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.checkAckArg(MessagingMessageListenerAdapter.java:374) ~[spring-kafka-2.8.5.jar:2.8.5]
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:355) ~[spring-kafka-2.8.5.jar:2.8.5]
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.5.jar:2.8.5]
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.5.jar:2.8.5]
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2637) ~[spring-kafka-2.8.5.jar:2.8.5]
Caused by: org.springframework.messaging.handler.annotation.support.MethodArgumentNotValidException: Could not resolve method parameter at index 0 in void ru.otus.homework03.listener.KafkaListeners.listener(java.lang.String): 1 error(s): [Error in object 'data': codes []; arguments []; default message [Payload value must not be empty]] 
	at org.springframework.messaging.handler.annotation.support.PayloadMethodArgumentResolver.resolveArgument(PayloadMethodArgumentResolver.java:122) ~[spring-messaging-5.3.16.jar:5.3.16]
	at org.springframework.kafka.annotation.KafkaNullAwarePayloadArgumentResolver.resolveArgument(KafkaNullAwarePayloadArgumentResolver.java:46) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.messaging.handler.invocation.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:118) ~[spring-messaging-5.3.16.jar:5.3.16]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:147) ~[spring-messaging-5.3.16.jar:5.3.16]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:115) ~[spring-messaging-5.3.16.jar:5.3.16]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2637) ~[spring-kafka-2.8.5.jar:2.8.5]
	... 11 common frames omitted

2022-05-13 22:17:28.426  INFO 21336 --- [main] ru.otus.homework03.Main                  : Starting Main using Java 14.0.1 on DESKTOP-KDSIOVU with PID 21336 (C:\projects\otus_homework\homework03\target\classes started by yanin in C:\projects\otus_homework\homework03)
2022-05-13 22:17:28.429  INFO 21336 --- [main] ru.otus.homework03.Main                  : No active profile set, falling back to 1 default profile: "default"
2022-05-13 22:17:29.354  INFO 21336 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-05-13 22:17:29.424  INFO 21336 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 63 ms. Found 5 JPA repository interfaces.
2022-05-13 22:17:30.040  INFO 21336 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2022-05-13 22:17:30.048  INFO 21336 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-05-13 22:17:30.048  INFO 21336 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-05-13 22:17:30.155  INFO 21336 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-05-13 22:17:30.156  INFO 21336 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1679 ms
2022-05-13 22:17:30.248  INFO 21336 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-05-13 22:17:30.316  INFO 21336 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-05-13 22:17:30.324  INFO 21336 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2022-05-13 22:17:30.570  INFO 21336 --- [main] liquibase.database                       : Set default schema name to PUBLIC
2022-05-13 22:17:30.697  INFO 21336 --- [main] liquibase.lockservice                    : Successfully acquired change log lock
2022-05-13 22:17:30.715  INFO 21336 --- [main] liquibase.changelog                      : Reading resource: db/changelog/1.0/2022-03-01--0001.xml
2022-05-13 22:17:31.081  INFO 21336 --- [main] liquibase.changelog                      : Creating database history table with name: PUBLIC.DATABASECHANGELOG
2022-05-13 22:17:31.084  INFO 21336 --- [main] liquibase.changelog                      : Reading from PUBLIC.DATABASECHANGELOG
2022-05-13 22:17:31.166  INFO 21336 --- [main] liquibase.changelog                      : Table authors created
2022-05-13 22:17:31.166  INFO 21336 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-authorsTableCreate::ryanin ran successfully in 23ms
2022-05-13 22:17:31.182  INFO 21336 --- [main] liquibase.changelog                      : Table genres created
2022-05-13 22:17:31.182  INFO 21336 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-genresTableCreate::ryanin ran successfully in 7ms
2022-05-13 22:17:31.197  INFO 21336 --- [main] liquibase.changelog                      : Table books created
2022-05-13 22:17:31.198  INFO 21336 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-01--0001-booksTableCreate::ryanin ran successfully in 15ms
2022-05-13 22:17:31.208  INFO 21336 --- [main] liquibase.changelog                      : Table commentaries created
2022-05-13 22:17:31.209  INFO 21336 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-commentariesTableCreate::ryanin ran successfully in 9ms
2022-05-13 22:17:31.219  INFO 21336 --- [main] liquibase.changelog                      : Table users created
2022-05-13 22:17:31.219  INFO 21336 --- [main] liquibase.changelog                      : ChangeSet db/changelog/1.0/2022-03-01--0001.xml::2022-03-11--0001-usersTableCreate::ryanin ran successfully in 9ms
2022-05-13 22:17:31.229  INFO 21336 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:17:31.230  INFO 21336 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/authorsTableFill.csv' into table 'authors'
2022-05-13 22:17:31.230  INFO 21336 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/authorsTableFill.xml::authorsTableFill::ryanin ran successfully in 9ms
2022-05-13 22:17:31.235  INFO 21336 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:17:31.235  INFO 21336 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/genresTableFill.csv' into table 'genres'
2022-05-13 22:17:31.236  INFO 21336 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/genresTableFill.xml::genresTableFill::ryanin ran successfully in 5ms
2022-05-13 22:17:31.241  INFO 21336 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:17:31.241  INFO 21336 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/booksTableFill.csv' into table 'books'
2022-05-13 22:17:31.242  INFO 21336 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/booksTableFill.xml::booksTableFill::ryanin ran successfully in 4ms
2022-05-13 22:17:31.257  INFO 21336 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:17:31.258  INFO 21336 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/commentariesTableFill.csv' into table 'commentaries'
2022-05-13 22:17:31.258  INFO 21336 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/commentariesTableFill.xml::commentariesTableFill::ryanin ran successfully in 4ms
2022-05-13 22:17:31.264  INFO 21336 --- [main] liquibase.statement                      : Executing JDBC DML batch was successful. 2 operations were executed, 1 individual UPDATE events were confirmed by the database.
2022-05-13 22:17:31.265  INFO 21336 --- [main] liquibase.changelog                      : Data loaded from 'db/changelog/data/usersTableFill.csv' into table 'users'
2022-05-13 22:17:31.265  INFO 21336 --- [main] liquibase.changelog                      : ChangeSet db/changelog/data/usersTableFill.xml::userTableFill::ryanin ran successfully in 5ms
2022-05-13 22:17:31.267  INFO 21336 --- [main] liquibase.lockservice                    : Successfully released change log lock
2022-05-13 22:17:31.353  INFO 21336 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-05-13 22:17:31.401  INFO 21336 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.5.Final
2022-05-13 22:17:31.498  INFO 21336 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-05-13 22:17:31.584  INFO 21336 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-05-13 22:17:32.012  INFO 21336 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-05-13 22:17:32.019  INFO 21336 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-05-13 22:17:32.290  WARN 21336 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-05-13 22:17:32.588  INFO 21336 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-05-13 22:17:33.026  INFO 21336 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 15 endpoint(s) beneath base path '/actuator'
2022-05-13 22:17:33.097  INFO 21336 --- [main] o.a.k.clients.admin.AdminClientConfig    : AdminClientConfig values: 
	bootstrap.servers = [localhost:9092]
	client.dns.lookup = use_all_dns_ips
	client.id = 
	connections.max.idle.ms = 300000
	default.api.timeout.ms = 60000
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS

2022-05-13 22:17:33.138  INFO 21336 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:17:33.139  INFO 21336 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:17:33.139  INFO 21336 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469453137
2022-05-13 22:17:33.377  INFO 21336 --- [kafka-admin-client-thread | adminclient-1] o.a.kafka.common.utils.AppInfoParser     : App info kafka.admin.client for adminclient-1 unregistered
2022-05-13 22:17:33.380  INFO 21336 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics scheduler closed
2022-05-13 22:17:33.380  INFO 21336 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Closing reporter org.apache.kafka.common.metrics.JmxReporter
2022-05-13 22:17:33.380  INFO 21336 --- [kafka-admin-client-thread | adminclient-1] org.apache.kafka.common.metrics.Metrics  : Metrics reporters closed
2022-05-13 22:17:33.397  INFO 21336 --- [main] o.a.k.clients.consumer.ConsumerConfig    : ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-testGroupId-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = testGroupId
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2022-05-13 22:17:33.423  INFO 21336 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:17:33.423  INFO 21336 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:17:33.423  INFO 21336 --- [main] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469453422
2022-05-13 22:17:33.424  INFO 21336 --- [main] o.a.k.clients.consumer.KafkaConsumer     : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Subscribed to topic(s): test
2022-05-13 22:17:33.441  INFO 21336 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2022-05-13 22:17:33.445  INFO 21336 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata        : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 22:17:33.446  INFO 21336 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Discovered group coordinator DESKTOP-KDSIOVU:9092 (id: 2147483647 rack: null)
2022-05-13 22:17:33.448  INFO 21336 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:17:33.455  INFO 21336 --- [main] ru.otus.homework03.Main                  : Started Main in 5.416 seconds (JVM running for 5.992)
2022-05-13 22:17:33.460  INFO 21336 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Request joining group due to: need to re-join with the given member-id
2022-05-13 22:17:33.460  INFO 21336 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] (Re-)joining group
2022-05-13 22:17:33.464  INFO 21336 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Successfully joined group with generation Generation{generationId=10, memberId='consumer-testGroupId-1-f5c4d55c-0357-42a9-bbd9-d3edfdebcb4a', protocol='range'}
2022-05-13 22:17:33.466  INFO 21336 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Finished assignment for group at generation 10: {consumer-testGroupId-1-f5c4d55c-0357-42a9-bbd9-d3edfdebcb4a=Assignment(partitions=[test-0])}
2022-05-13 22:17:33.472  INFO 21336 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Successfully synced group in generation Generation{generationId=10, memberId='consumer-testGroupId-1-f5c4d55c-0357-42a9-bbd9-d3edfdebcb4a', protocol='range'}
2022-05-13 22:17:33.473  INFO 21336 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Notifying assignor about the new Assignment(partitions=[test-0])
2022-05-13 22:17:33.475  INFO 21336 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Adding newly assigned partitions: test-0
2022-05-13 22:17:33.485  INFO 21336 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerCoordinator  : [Consumer clientId=consumer-testGroupId-1, groupId=testGroupId] Setting offset for partition test-0 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[DESKTOP-KDSIOVU:9092 (id: 0 rack: null)], epoch=0}}
2022-05-13 22:17:33.486  INFO 21336 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer    : testGroupId: partitions assigned: [test-0]
2022-05-13 22:17:33.868  INFO 21336 --- [RMI TCP Connection(12)-169.254.74.73] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-05-13 22:17:33.868  INFO 21336 --- [RMI TCP Connection(12)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-05-13 22:17:33.870  INFO 21336 --- [RMI TCP Connection(12)-169.254.74.73] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2022-05-13 22:17:43.151  INFO 21336 --- [http-nio-8080-exec-2] o.a.k.clients.producer.ProducerConfig    : ProducerConfig values: 
	acks = -1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.mechanism = GSSAPI
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2022-05-13 22:17:43.165  INFO 21336 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka version: 3.0.0
2022-05-13 22:17:43.165  INFO 21336 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka commitId: 8cb0a5e9d3441962
2022-05-13 22:17:43.165  INFO 21336 --- [http-nio-8080-exec-2] o.a.kafka.common.utils.AppInfoParser     : Kafka startTimeMs: 1652469463165
2022-05-13 22:17:43.169  INFO 21336 --- [kafka-producer-network-thread | producer-1] org.apache.kafka.clients.Metadata        : [Producer clientId=producer-1] Cluster ID: FWt9bMu4Q76tu3uB2XQbCA
2022-05-13 22:17:43.206 ERROR 21336 --- [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.kafka.listener.DefaultErrorHandler   : Backoff none exhausted for test-0@6

org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method could not be invoked with the incoming message
Endpoint handler details:
Method [void ru.otus.homework03.listener.KafkaListeners.listener(java.lang.String)]
Bean [ru.otus.homework03.listener.KafkaListeners@71db6703]; nested exception is org.springframework.messaging.handler.annotation.support.MethodArgumentNotValidException: Could not resolve method parameter at index 0 in void ru.otus.homework03.listener.KafkaListeners.listener(java.lang.String): 1 error(s): [Error in object 'message': codes []; arguments []; default message [Payload value must not be empty]] , failedMessage=GenericMessage [payload=org.springframework.kafka.support.KafkaNull@6a56cf18, headers={kafka_offset=6, kafka_consumer=org.apache.kafka.clients.consumer.KafkaConsumer@54870447, kafka_timestampType=CREATE_TIME, kafka_receivedPartitionId=0, kafka_receivedTopic=test, kafka_receivedTimestamp=1652469463174, kafka_groupId=testGroupId}]; nested exception is org.springframework.messaging.handler.annotation.support.MethodArgumentNotValidException: Could not resolve method parameter at index 0 in void ru.otus.homework03.listener.KafkaListeners.listener(java.lang.String): 1 error(s): [Error in object 'message': codes []; arguments []; default message [Payload value must not be empty]] , failedMessage=GenericMessage [payload=org.springframework.kafka.support.KafkaNull@6a56cf18, headers={kafka_offset=6, kafka_consumer=org.apache.kafka.clients.consumer.KafkaConsumer@54870447, kafka_timestampType=CREATE_TIME, kafka_receivedPartitionId=0, kafka_receivedTopic=test, kafka_receivedTimestamp=1652469463174, kafka_groupId=testGroupId}]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2687) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2657) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2617) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2544) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2429) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2307) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1981) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1365) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1356) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1251) ~[spring-kafka-2.8.5.jar:2.8.5]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:832) ~[na:na]
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.checkAckArg(MessagingMessageListenerAdapter.java:374) ~[spring-kafka-2.8.5.jar:2.8.5]
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:355) ~[spring-kafka-2.8.5.jar:2.8.5]
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.5.jar:2.8.5]
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.5.jar:2.8.5]
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2637) ~[spring-kafka-2.8.5.jar:2.8.5]
Caused by: org.springframework.messaging.handler.annotation.support.MethodArgumentNotValidException: Could not resolve method parameter at index 0 in void ru.otus.homework03.listener.KafkaListeners.listener(java.lang.String): 1 error(s): [Error in object 'message': codes []; arguments []; default message [Payload value must not be empty]] 
	at org.springframework.messaging.handler.annotation.support.PayloadMethodArgumentResolver.resolveArgument(PayloadMethodArgumentResolver.java:122) ~[spring-messaging-5.3.16.jar:5.3.16]
	at org.springframework.kafka.annotation.KafkaNullAwarePayloadArgumentResolver.resolveArgument(KafkaNullAwarePayloadArgumentResolver.java:46) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.messaging.handler.invocation.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:118) ~[spring-messaging-5.3.16.jar:5.3.16]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:147) ~[spring-messaging-5.3.16.jar:5.3.16]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:115) ~[spring-messaging-5.3.16.jar:5.3.16]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.5.jar:2.8.5]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2637) ~[spring-kafka-2.8.5.jar:2.8.5]
	... 11 common frames omitted

